{"repository_name":"openapi-generator","body":"# openapi-generator\n\n[![Build Status](https://travis-ci.org/elbywan/openapi-generator.svg?branch=master)](https://travis-ci.org/elbywan/openapi-generator)\n\n#### Generate an [OpenAPI v3 compliant](https://swagger.io/specification/) yaml file declaratively from your web framework code.\n\nThen serve it from a [Swagger UI](https://swagger.io/tools/swagger-ui/) instance.\n\n## Setup\n\n1. Add the dependency to your `shard.yml`:\n\n```yaml\ndependencies:\n  openapi-generator:\n    github: elbywan/openapi-generator\n    version: ~> 0.3.0\n```\n\n2. Run `shards install`\n\n3. Require the shard\n\n```crystal\nrequire \"openapi-generator\"\n```\n\n## API Documentation\n\n[**Please check this link for the API documentation.**](https://elbywan.github.io/openapi-generator/OpenAPI/Generator.html)\n\n## Concepts\n\n### Declare Operations\n\n*From the [OpenAPI specification](https://swagger.io/docs/specification/paths-and-operations/).*\n\n> In OpenAPI terms, paths are endpoints (resources), such as /users or /reports/summary/, that your API exposes, and operations are the HTTP methods used to manipulate these paths, such as GET, POST or DELETE.\n\n#### Method based (`Amber`, `Spider-gazelle`)\n\nUse the `@[OpenAPI]` annotation with a `yaml` encoded string argument.\n\n```crystal\nclass Controller\n  include OpenAPI::Generator::Controller\n\n  @[OpenAPI(<<-YAML\n    tags:\n      - tag\n    summary:\n      A brief summary.\n  YAML\n  )]\n  def handler\n    # …\n  end\nend\n```\n\n#### Class based (`Lucky`)\n\nUse the `open_api` macro with a `yaml` encoded string argument.\n\n```crystal\nclass Handler\n  include OpenAPI::Generator::Controller\n\n  open_api <<-YAML\n    tags:\n      - tag\n    summary:\n      A brief summary.\n  YAML\n\n  route do\n    # …\n  end\nend\n```\n\n#### Shorthands\n\nThe [`OpenAPI::Generator::Controller::Schema`](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/Controller/Schema.html) class exposes shorthands for common OpenAPI yaml constructs.\n\n```crystal\n# Example:\n\nopen_api <<-YAML\n  tags:\n    - tag\n  summary:\n    A brief summary.\n  parameters:\n    #{Schema.qp name: \"id\", description: \"Filter by id.\", required: true}\n  responses:\n    200:\n      description: OK\n    #{Schema.error 404}\nYAML\n```\n\n- [`Schema.error(code, message = nil)`](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/Controller/Schema.html#error(code,message=nil)-instance-method)\n- [`Schema.header(name, description, type = \"string\")`](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/Controller/Schema.html#header(name,description,type=%22string%22)-instance-method)\n- [`Schema.header_param(name, description, *, required = false, type = \"string\")`](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/Controller/Schema.html#header_param(name,description,*,required=false,type=%22string%22)-instance-method)\n- [`Schema.qp(name, description, *, required = false, type = \"string\")`](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/Controller/Schema.html#qp(name,description,*,required=false,type=%22string%22)-instance-method)\n- [`Schema.ref(schema, *, content_type = \"application/json\")`](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/Controller/Schema.html#ref(schema,*,content_type=%22application/json%22)-instance-method)\n- [`Schema.ref_array(schema, *, content_type = \"application/json\")`](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/Controller/Schema.html#ref_array(schema,*,content_type=%22application/json%22)-instance-method)\n- [`Schema.string_array(*, content_type = \"application/json\")`](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/Controller/Schema.html#string_array(*,content_type=%22application/json%22)-instance-method)\n\n### `openapi.yaml` Generation\n\n**After** declaring the operations, you can call `OpenAPI::Generator.generate` to generate the `openapi.yaml` file that will describe your server.\n\n**Note**: An [`OpenAPI::Generator::RoutesProvider::Base`](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/RoutesProvider.html) implementation must be provided. A `RoutesProvider` is responsible from extracting the [server routes and mapping these routes with the declared operations](https://elbywan.github.io/openapi-generator/OpenAPI/Generator/RouteMapping.html) in order to produce the final openapi file.\n\nCurrently, the [Amber](https://amberframework.org/), [Lucky](https://luckyframework.org), [Spider-gazelle](https://spider-gazelle.net/) providers are included out of the box.\n\n```crystal\n# Amber provider\nrequire \"openapi-generator/providers/amber\"\n\nOpenAPI::Generator.generate(\n  provider: OpenAPI::Generator::RoutesProvider::Amber.new\n)\n```\n\n```crystal\n# Spider-gazelle provider\nrequire \"openapi-generator/providers/action-controller\"\n\nOpenAPI::Generator.generate(\n  provider: OpenAPI::Generator::RoutesProvider::ActionController.new\n)\n```\n\n```crystal\n# Lucky provider\nrequire \"openapi-generator/providers/lucky\"\n\nOpenAPI::Generator.generate(\n  provider: OpenAPI::Generator::RoutesProvider::Lucky.new\n)\n```\n\n```crystal\n# Or define your own…\nclass MockProvider < OpenAPI::Generator::RoutesProvider::Base\n  def route_mappings : Array(OpenAPI::Generator::RouteMapping)\n    [\n      {\"get\", \"/{id}\", \"HelloController::index\", [\"id\"]},\n      {\"head\", \"/{id}\", \"HelloController::index\", [\"id\"]},\n      {\"options\", \"/{id}\", \"HelloController::index\", [\"id\"]},\n    ]\n  end\nend\n\nOpenAPI::Generator.generate(\n  provider: MockProvider.new\n)\n```\n\nThe `.generate` method accepts additional options:\n\n```crystal\nOpenAPI::Generator.generate(\n  provider: provider,\n  options: {\n    # Customize output path\n    output: Path[Dir.current] / \"public\" / \"openapi.yaml\"\n  },\n  # Customize openapi.yaml base document fields\n  base_document: {\n    info: {\n        title:   \"My Server\",\n        version: \"v0.1\",\n      }\n  }\n)\n```\n\n### Schema Serialization\n\nAdding `extend OpenAPI::Generator::Serializable` to an existing class or struct will:\n- register the object as a reference making it useable anywhere in the openapi file\n- add a `.to_openapi_schema` method that will produce the associated `OpenAPI::Schema`\n\n```crystal\nclass Coordinates\n  extend OpenAPI::Generator::Serializable\n\n  def initialize(@lat, @long); end\n\n  property lat  : Int32\n  property long : Int32\nend\n\n# Produces an OpenAPI::Schema reference.\nputs Coordinates.to_openapi_schema.to_yaml\n# ---\n# allOf:\n# - $ref: '#/components/schemas/Coordinates'\n```\n\nAnd in the `openapi.yaml` file that gets generated, the `Coordinates` object is registered as a `/components/schemas/Coordinates` reference.\n\n```yaml\ncomponents:\n  schemas:\n    Coordinates:\n      required:\n      - lat\n      - long\n      type: object\n      properties:\n        lat:\n          type: integer\n        long:\n          type: integer\n```\n\n#### In practice\n\nThe object can now be referenced from the yaml declaration…\n\n```crystal\nclass Controller\n  include OpenAPI::Generator::Controller\n\n  @[OpenAPI(<<-YAML\n    requestBody:\n      required: true\n      content:\n        #{Schema.ref Coordinates}\n  YAML\n  )]\n  def method\n    # …\n  end\nend\n```\n\n…and it can be used by the schema inference (more on that later).\n\n```crystal\nclass Hello::Index < Lucky::Action\n  include OpenAPI::Generator::Helpers::Lucky\n\n  disable_cookies\n  default_format :text\n\n  post \"/hello\" do\n    coordinates = body_as Coordinates?, description: \"Some coordinates.\"\n\n    plain_text \"Hello (#{coordinates.x}, #{coordinates.y})\"\n  end\nend\n```\n\n#### Customize fields\n\nUse the `@[OpenAPI::Field]` annotation to add properties to the fields.\n\n```crystal\nclass MyClass\n  extend OpenAPI::Generator::Serializable\n\n  # Ignore the field. It will not appear in the schema.\n  @[OpenAPI::Field(ignore: true)]\n  property ignored_field\n\n  # Enforce a type in the schema and disregard the crystal type.\n  @[OpenAPI::Field(type: String)]\n  property str_field : Int32\n\n  # Add an example that will appear in swagger for instance.\n  @[OpenAPI::Field(example: \"an example value\")]\n  property some_field : String\n\n  # Will not appear in POST / PUT/ PATCH requests body.\n  @[OpenAPI::Field(read_only: true)]\n  property read_only_field : String\n\n  # Will only appear in POST / PUT / PATCH requests body.\n  @[OpenAPI::Field(write_only: true)]\n  property write_only_field : String\nend\n```\n\n## Inference (Optional)\n\n`openapi-generator` can infer some schema properties from the code, removing the need to declare it with yaml.\n\n**Can be inferred:**\n- Request body\n- Response body\n- Query parameters\n\n**Supported Frameworks:**\n- Lucky\n- Amber\n- Spider-gazelle\n\n### Amber\n\n```crystal\nrequire \"openapi-generator/helpers/amber\"\n\n# …declare routes and operations… #\n\n# Before calling .generate you need to bootstrap the amber inference:\nOpenAPI::Generator::Helpers::Amber.bootstrap\n```\n\n#### Example\n\n```crystal\nrequire \"openapi-generator/helpers/amber\"\n\nclass Coordinates\n  include JSON::Serializable\n  extend OpenAPI::Generator::Serializable\n\n  def initialize(@x, @y); end\n\n  property x  : Int32\n  property y  : Int32\nend\n\nclass CoordinatesController < Amber::Controller::Base\n  include ::OpenAPI::Generator::Controller\n  include ::OpenAPI::Generator::Helpers::Amber\n\n  @[OpenAPI(\n    <<-YAML\n      summary: Adds up a Coordinate object and a number.\n    YAML\n  )]\n  def add\n    # Infer query parameter.\n    add = query_params(\"add\", description: \"Add this number to the coordinates.\").to_i32\n    # Infer body as a Coordinate json payload.\n    coordinates = body_as(::Coordinates, description: \"Some coordinates\").not_nil!\n    coordinates.x += add\n    coordinates.y += add\n\n    # Infer responses.\n    respond_with 200, description: \"Returns a Coordinate object with the number added up.\" do\n      json coordinates, type: ::Coordinates\n      xml %(<coordinate x=\"#{coordinates.x}\" y=\"#{coordinates.y}\"></coordinate>), type: String\n      text \"Coordinates (#{coordinates.x}, #{coordinates.y})\", type: String\n    end\n  end\nend\n```\n\n#### API\n\n`openapi-generator` overload existing or adds similar methods and macros to intercept calls and infer schema properties.\n\n*Query parameters*\n\n- `macro query_params(name, description, multiple = false, schema = nil, **args)`\n- `macro query_params?(name, description, multiple = false, schema = nil, **args)`\n\n*Body*\n\n- `macro body_as(type, description = nil, content_type = \"application/json\", constructor = :from_json)`\n\n*Responses*\n\n- `macro respond_with(code = 200, description = nil, headers = nil, links = nil, &)`\n\n- `macro json(body, type = nil, schema = nil)`\n- `macro xml(body, type = nil, schema = nil)`\n- `macro txt(body, type = nil, schema = nil)`\n- `macro text(body, type = nil, schema = nil)`\n- `macro html(body, type = nil, schema = nil)`\n- `macro js(body, type = nil, schema = nil)`\n\n### Spider-gazelle\n\n```crystal\nrequire \"openapi-generator/helpers/action-controller\"\n\n# …declare routes and operations… #\n\n# Before calling .generate you need to bootstrap the spider-gazelle inference:\nOpenAPI::Generator::Helpers::ActionController.bootstrap\n```\n\n#### Example\n\n```crystal\nrequire \"openapi-generator/helpers/action-controller\"\n\nclass Coordinates\n  include JSON::Serializable\n  extend OpenAPI::Generator::Serializable\n\n  def initialize(@x, @y); end\n\n  property x  : Int32\n  property y  : Int32\nend\n\nclass CoordinatesController < ActionController::Controller::Base\n  include ::OpenAPI::Generator::Controller\n  include ::OpenAPI::Generator::Helpers::ActionController\n\n  @[OpenAPI(\n    <<-YAML\n      summary: Adds up a Coordinate object and a number.\n    YAML\n  )]\n  def add\n    # Infer query parameter.\n    add = param add : Int32, description: \"Add this number to the coordinates.\"\n    # Infer body as a Coordinate json payload.\n    coordinates = body_as(::Coordinates, description: \"Some coordinates\").not_nil!\n    coordinates.x += add\n    coordinates.y += add\n\n    # Infer responses.\n    respond_with 200, description: \"Returns a Coordinate object with the number added up.\" do\n      json coordinates, type: ::Coordinates\n      xml %(<coordinate x=\"#{coordinates.x}\" y=\"#{coordinates.y}\"></coordinate>), type: String\n      text \"Coordinates (#{coordinates.x}, #{coordinates.y})\", type: String\n    end\n  end\nend\n```\n\n#### API\n\n`openapi-generator` overload existing or adds similar methods and macros to intercept calls and infer schema properties.\n\n*Query parameters*\n\n- `macro param(declaration, description, multiple = false, schema = nil, **args)`\n\n*Body*\n\n- `macro body_as(type, description = nil, content_type = \"application/json\", constructor = :from_json)`\n\n*Responses*\n\n- `macro respond_with(code = 200, description = nil, headers = nil, links = nil, &)`\n  - `macro json(body, type = nil, schema = nil)`\n  - `macro xml(body, type = nil, schema = nil)`\n  - `macro txt(body, type = nil, schema = nil)`\n  - `macro text(body, type = nil, schema = nil)`\n  - `macro html(body, type = nil, schema = nil)`\n  - `macro js(body, type = nil, schema = nil)`\n\n-  `macro render(status_code = :ok, head = Nop, json = Nop, yaml = Nop, xml = Nop, html = Nop, text = Nop, binary = Nop, template = Nop, partial = Nop, layout = nil, description = nil, headers = nil, links = nil, type = nil, schema = nil)`\n\n### Lucky\n\n```crystal\nrequire \"openapi-generator/helpers/lucky\"\n\n# …declare routes and operations… #\n\n# Before calling .generate you need to bootstrap the lucky inference:\nOpenAPI::Generator::Helpers::Lucky.bootstrap\n```\n\n**Important:** In your Actions, use `include OpenAPI::Generator::Helpers::Lucky` instead of `include OpenAPI::Generator::Controller`.\n\n#### Example\n\n```crystal\nrequire \"openapi-generator/helpers/lucky\"\n\nclass Coordinates\n  include JSON::Serializable\n  extend OpenAPI::Generator::Serializable\n\n  def initialize(@x, @y); end\n\n  property x  : Int32\n  property y  : Int32\nend\n\nclass Api::Coordinates::Create < Lucky::Action\n  # `OpenAPI::Generator::Controller` is included alongside `OpenAPI::Generator::Helpers::Lucky`.\n  include OpenAPI::Generator::Helpers::Lucky\n\n  disable_cookies\n  default_format :json\n\n  # Infer query parameter.\n  param add : Int32, description: \"Add this number to the coordinates.\"\n\n  def action\n    # Infer body as a Coordinate json payload.\n    coordinates = body_as! ::Coordinates, description: \"Some coordinates\"\n    coordinates.x += add\n    coordinates.y += add\n\n    # Infer responses.\n    if json?\n      json coordinates, type: ::Coordinates\n    elsif  xml?\n      xml %(<coordinate x=\"#{coordinates.x}\" y=\"#{coordinates.y}\"></coordinate>), schema: OpenAPI::Schema.new(type: \"string\")\n    elsif plain_text?\n      plain_text \"Coordinates (#{coordinates.x}, #{coordinates.y})\"\n    else\n      head 406\n    end\n  end\n\n  route { action }\nend\n```\n\n#### API\n\n`openapi-generator` overload existing or adds similar methods and macros to intercept calls and infer schema properties.\n\n*Query parameters*\n\n- `macro param(declaration, description = nil, schema = nil, **args)`\n\n*Body*\n\n- `macro body_as(type, description = nil, content_type = \"application/json\", constructor = :from_json)`\n- `macro body_as!(type, description = nil, content_type = \"application/json\", constructor = :from_json)`\n\n*Responses*\n\n- `macro json(body, status = 200, description = nil, type = nil, schema = nil, headers = nil, links = nil)`\n- `macro head(status, description = nil, headers = nil, links = nil)`\n- `macro xml(body, status = 200, description = nil, type = String, schema = nil, headers = nil, links = nil)`\n- `macro plain_text(body, status = 200, description = nil, type = String, schema = nil, headers = nil, links = nil)`\n\n## Swagger UI\n\nThe method to serve a Swagger UI instance depends on which framework you are using.\n\n1. Setup a static file handler. (ex: [Lucky](https://luckyframework.org/guides/http-and-routing/http-handlers#built-in-handlers), [Amber](https://docs.amberframework.org/amber/guides/routing/pipelines))\n2. Download [the latest release archive](https://github.com/swagger-api/swagger-ui/releases)\n3. Move the `/dist` folder to your static file directory.\n4. Edit the `index.html` file and change the assets and `openapi.yaml` paths.\n\n## Contributing\n\n1. Fork it (<https://github.com/your-github-user/openapi-generator/fork>)\n2. Create your feature branch (`git checkout -b my-new-feature`)\n3. Commit your changes (`git commit -am 'Add some feature'`)\n4. Push to the branch (`git push origin my-new-feature`)\n5. Create a new Pull Request\n\n## Contributors\n\n- [elbywan](https://github.com/elbywan) - creator and maintainer\n- [dukeraphaelng](https://github.com/dukeraphaelng)","program":{"html_id":"openapi-generator/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"openapi-generator","program":true,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"openapi-generator/OpenAPI","path":"OpenAPI.html","kind":"module","full_name":"OpenAPI","name":"OpenAPI","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"lib/open_api/src/open_api.cr","line_number":3,"url":null},{"filename":"lib/open_api/src/open_api/components.cr","line_number":16,"url":null},{"filename":"lib/open_api/src/open_api/contact.cr","line_number":3,"url":null},{"filename":"lib/open_api/src/open_api/document.cr","line_number":8,"url":null},{"filename":"lib/open_api/src/open_api/encoding.cr","line_number":5,"url":null},{"filename":"lib/open_api/src/open_api/example.cr","line_number":3,"url":null},{"filename":"lib/open_api/src/open_api/external_documentation.cr","line_number":3,"url":null},{"filename":"lib/open_api/src/open_api/header.cr","line_number":6,"url":null},{"filename":"lib/open_api/src/open_api/info.cr","line_number":5,"url":null},{"filename":"lib/open_api/src/open_api/license.cr","line_number":3,"url":null},{"filename":"lib/open_api/src/open_api/link.cr","line_number":4,"url":null},{"filename":"lib/open_api/src/open_api/mass_assignment.cr","line_number":1,"url":null},{"filename":"lib/open_api/src/open_api/media_type.cr","line_number":5,"url":null},{"filename":"lib/open_api/src/open_api/oauth_flow.cr","line_number":3,"url":null},{"filename":"lib/open_api/src/open_api/oauth_flows.cr","line_number":4,"url":null},{"filename":"lib/open_api/src/open_api/object.cr","line_number":4,"url":null},{"filename":"lib/open_api/src/open_api/operation.cr","line_number":10,"url":null},{"filename":"lib/open_api/src/open_api/parameter.cr","line_number":6,"url":null},{"filename":"lib/open_api/src/open_api/path_item.cr","line_number":7,"url":null},{"filename":"lib/open_api/src/open_api/reference.cr","line_number":3,"url":null},{"filename":"lib/open_api/src/open_api/request_body.cr","line_number":4,"url":null},{"filename":"lib/open_api/src/open_api/response.cr","line_number":7,"url":null},{"filename":"lib/open_api/src/open_api/schema.cr","line_number":4,"url":null},{"filename":"lib/open_api/src/open_api/schemas.cr","line_number":4,"url":null},{"filename":"lib/open_api/src/open_api/security_scheme.cr","line_number":4,"url":null},{"filename":"lib/open_api/src/open_api/server.cr","line_number":4,"url":null},{"filename":"lib/open_api/src/open_api/server_variable.cr","line_number":3,"url":null},{"filename":"lib/open_api/src/open_api/tag.cr","line_number":4,"url":null},{"filename":"src/openapi-generator/controller.cr","line_number":40,"url":null},{"filename":"src/openapi-generator/extensions.cr","line_number":113,"url":null},{"filename":"src/openapi-generator/openapi.cr","line_number":7,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"openapi-generator/OpenAPI/Field","path":"OpenAPI/Field.html","kind":"annotation","full_name":"OpenAPI::Field","name":"Field","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/serializable.cr","line_number":70,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI","kind":"module","full_name":"OpenAPI","name":"OpenAPI"},"doc":"Mark a field with special properties during serialization.\n\n```\n@[OpenAPI::Field(ignore: true)] # Ignore the field\nproperty ignored_field\n\n@[OpenAPI::Field(type: String)] # Enforce a type\nproperty str_field : Int32\n\n# The example value can be any value of type JSON::Any::Type, meaning a string, numbers, booleans, or an array or a hash of json values.\n@[OpenAPI::Field(example: \"an example value\")]\nproperty a_field : String\n```","summary":"<p>Mark a field with special properties during serialization.</p>","class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"openapi-generator/OpenAPI/Generator","path":"OpenAPI/Generator.html","kind":"module","full_name":"OpenAPI::Generator","name":"Generator","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/controller.cr","line_number":40,"url":null},{"filename":"src/openapi-generator/generator.cr","line_number":145,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[{"id":"DEFAULT_OPTIONS","name":"DEFAULT_OPTIONS","value":"{output: Path[Dir.current] / \"openapi.yaml\"}","doc":null,"summary":null},{"id":"Log","name":"Log","value":"::Log.for(self)","doc":null,"summary":null}],"included_modules":[],"extended_modules":[{"html_id":"openapi-generator/OpenAPI/Generator","kind":"module","full_name":"OpenAPI::Generator","name":"Generator"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI","kind":"module","full_name":"OpenAPI","name":"OpenAPI"},"doc":"An OpenAPI yaml specifications file generator.\n\n### Complete example\n\n```\nrequire \"openapi-generator\"\n\n# The following example is using [Amber](https://amberframework.org/)\n# but this library is compatible with any web framework.\n\nrequire \"amber\"\nrequire \"openapi-generator/providers/amber\"\n\n# Optional: auto-serialize classes into openapi schema.\n# A typed Model class can be used as the source of truth.\nclass Coordinates\n  extend OpenAPI::Generator::Serializable\n\n  def initialize(@lat, @long); end\n\n  property lat : Int32\n  property long : Int32\nend\n\n# Annotate the methods that will appear in the openapi file.\nclass Controller < Amber::Controller::Base\n  include OpenAPI::Generator::Controller\n\n  @[OpenAPI(<<-YAML\n    tags:\n    - tag\n    summary: A brief summary of the method.\n    requestBody:\n      required: true\n      content:\n        #{Schema.ref Coordinates}\n    required: true\n    responses:\n      200:\n        description: OK\n      #{Schema.error 404}\n  YAML\n  )]\n  def method\n    # Some code…\n  end\nend\n\n# Add the routes.\nAmber::Server.configure do\n  routes :api do\n    post \"/method/:id\", Controller, :method\n  end\nend\n\n# Generate the openapi file.\n\nOpenAPI::Generator.generate(\n  provider: OpenAPI::Generator::RoutesProvider::Amber.new\n)\n```\n\nWill produce an `./openapi.yaml` file with the following contents:\n\n```yaml\n---\nopenapi: 3.0.1\ninfo:\n  title: Server\n  version: \"1\"\npaths:\n  /method/{id}:\n    post:\n      tags:\n      - tag\n      summary: A brief summary of the method.\n      parameters:\n      - name: id\n        in: path\n        required: true\n        schema:\n          type: string\n        example: id\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/Coordinates'\n        required: true\n      responses:\n        \"200\":\n          description: OK\n        \"404\":\n          description: Not Found.\n    options:\n      tags:\n      - tag\n      summary: A brief summary of the method.\n      parameters:\n      - name: id\n        in: path\n        required: true\n        schema:\n          type: string\n        example: id\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/Coordinates'\n        required: true\n      responses:\n        \"200\":\n          description: OK\n        \"404\":\n          description: Not Found.\ncomponents:\n  schemas:\n    Coordinates:\n      required:\n      - lat\n      - long\n      type: object\n      properties:\n        lat:\n          type: integer\n        long:\n          type: integer\n  responses: {}\n  parameters: {}\n  examples: {}\n  requestBodies: {}\n  headers: {}\n  securitySchemes: {}\n  links: {}\n  callbacks: {}\n```\n\n### Usage\n\n","summary":"<p>An OpenAPI yaml specifications file generator.</p>","class_methods":[],"constructors":[],"instance_methods":[{"id":"generate(provider:OpenAPI::Generator::RoutesProvider::Base,*,options=NamedTuple.new,base_document={info:{title:&quot;Server&quot;,version:&quot;1&quot;}})-instance-method","html_id":"generate(provider:OpenAPI::Generator::RoutesProvider::Base,*,options=NamedTuple.new,base_document={info:{title:&quot;Server&quot;,version:&quot;1&quot;}})-instance-method","name":"generate","doc":"Generate an OpenAPI yaml file.\n\nAn `OpenAPI::Generator::RoutesProvider::Base` implementation must be provided.\n\nCurrently, only the [Amber](https://amberframework.org/) and [Lucky](https://luckyframework.org) providers are included out of the box\nbut writing a custom provider should be easy.\n\n### Example\n\n```\nclass MockProvider < OpenAPI::Generator::RoutesProvider::Base\n  def route_mappings : Array(OpenAPI::Generator::RouteMapping)\n    [\n      {\"get\", \"/{id}\", \"HelloController::index\", [\"id\"]},\n      {\"head\", \"/{id}\", \"HelloController::index\", [\"id\"]},\n      {\"options\", \"/{id}\", \"HelloController::index\", [\"id\"]},\n    ]\n  end\nend\n\noptions = {\n  output: Path[Dir.current] / \"public\" / \"openapi.yaml\",\n}\nbase_document = {\n  info: {\n    title:   \"Test\",\n    version: \"0.0.1\",\n  },\n  components: NamedTuple.new,\n}\nOpenAPI::Generator.generate(\n  MockProvider.new,\n  options: options,\n  base_document: base_document\n)\n```","summary":"<p>Generate an OpenAPI yaml file.</p>","abstract":false,"args":[{"name":"provider","doc":null,"default_value":"","external_name":"provider","restriction":"OpenAPI::Generator::RoutesProvider::Base"},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"options","doc":null,"default_value":"NamedTuple.new","external_name":"options","restriction":""},{"name":"base_document","doc":null,"default_value":"{info: {title: \"Server\", version: \"1\"}}","external_name":"base_document","restriction":""}],"args_string":"(provider : OpenAPI::Generator::RoutesProvider::Base, *, options = <span class=\"t\">NamedTuple</span>.<span class=\"k\">new</span>, base_document = {info: {title: <span class=\"s\">&quot;Server&quot;</span>, version: <span class=\"s\">&quot;1&quot;</span>}})","args_html":"(provider : <a href=\"../OpenAPI/Generator/RoutesProvider/Base.html\">OpenAPI::Generator::RoutesProvider::Base</a>, *, options = <span class=\"t\">NamedTuple</span>.<span class=\"k\">new</span>, base_document = {info: {title: <span class=\"s\">&quot;Server&quot;</span>, version: <span class=\"s\">&quot;1&quot;</span>}})","location":{"filename":"src/openapi-generator/generator.cr","line_number":197,"url":null},"def":{"name":"generate","args":[{"name":"provider","doc":null,"default_value":"","external_name":"provider","restriction":"OpenAPI::Generator::RoutesProvider::Base"},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"options","doc":null,"default_value":"NamedTuple.new","external_name":"options","restriction":""},{"name":"base_document","doc":null,"default_value":"{info: {title: \"Server\", version: \"1\"}}","external_name":"base_document","restriction":""}],"double_splat":null,"splat_index":1,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"routes = provider.route_mappings\npath_items = {} of String => OpenAPI::PathItem\noptions = DEFAULT_OPTIONS.merge(options)\nroutes = routes.sort do |a, b|\n  a[1] <=> b[1]\nend\nroutes.each do |route|\n  method, full_path, key, path_params = route\n  if yaml_op = Controller::CONTROLLER_OPS[key]?\n    begin\n      yaml_op_any = yaml_op\n      __temp_48 = full_path\n      path_items[__temp_48]? || (path_items[__temp_48] = OpenAPI::PathItem.new)\n      op = OpenAPI::Operation.from_json(yaml_op_any.to_json)\n      if path_params.size > 0\n        op.parameters || (op.parameters = [] of OpenAPI::Parameter | OpenAPI::Reference)\n      end\n      path_params.each do |param|\n        op.parameters.not_nil!.unshift(OpenAPI::Parameter.new(in: \"path\", name: param, required: true, example: param, schema: OpenAPI::Schema.new(type: \"string\")))\n      end\n      {% if true %}\n          {% methods = [\"get\", \"put\", \"post\", \"delete\", \"options\", \"head\", \"patch\", \"trace\"] of ::String %}\n\n          case method\n          {% for method in methods %}\n          when \"{{ method.id }}\"\n            path_items[full_path].{{ method.id }} = op\n          {% end %}\n          else\n            raise \"Unsupported method: #{method}.\"\n          end\n\n          {% end %}\n    rescue err\n      Log.error do\n        \"Error while generating bindings for path [#{full_path}].\\n\\n#{err}\\n\\n#{yaml_op}\"\n      end\n    end\n  else\n    Log.warn do\n      \"#{full_path} (#{method.upcase}) : Route is undocumented.\"\n    end\n  end\nend\ncomponents = if components_tuple = base_document[\"components\"]?\n  ::OpenAPI::Components.new(**components_tuple)\nelse\n  ::OpenAPI::Components.new\nend\ncomponents.schemas = Serializable.schemas\nbase_document = base_document.merge({openapi: \"3.0.1\", info: base_document[\"info\"], paths: path_items, components: components})\ndoc = OpenAPI.build do |api|\n  api.document(**base_document)\nend\nFile.write(options[\"output\"].to_s, doc.to_yaml)\n"}}],"macros":[],"types":[{"html_id":"openapi-generator/OpenAPI/Generator/Controller","path":"OpenAPI/Generator/Controller.html","kind":"module","full_name":"OpenAPI::Generator::Controller","name":"Controller","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/controller.cr","line_number":40,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[{"id":"CONTROLLER_OPS","name":"CONTROLLER_OPS","value":"{} of String => YAML::Any","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator","kind":"module","full_name":"OpenAPI::Generator","name":"Generator"},"doc":"This module, when included, will register every instance methods annotated with the `OpenAPI` annotation.\n\n### Example\n\n```\nclass Controller\n  include OpenAPI::Generator::Controller\n\n  @[OpenAPI(<<-YAML\n    tags:\n    - tag\n    summary: A brief summary of the method.\n    requestBody:\n      content:\n        #{Schema.ref SerializableClass}\n        application/x-www-form-urlencoded:\n          schema:\n            $ref: '#/components/schemas/SerializableClass'\n      required: true\n    responses:\n      \"303\":\n        description: Operation completed successfully, and redirects to /.\n      \"404\":\n        description: Data not found.\n      #{Schema.error 400}\n  YAML\n  )]\n  def method; end\nend\n```\n\n### Usage\n\nIncluding this module will register and mark every instance method annotated with a valid `@[OpenAPI]` annotation during the compilation phase.\nThese methods will then be taken into account when calling the `Generator` as long as the method can be mapped to a route.\n\nThe `Schema` module contains various helpers to generate YAML parts.","summary":"<p>This module, when included, will register every instance methods annotated with the <code><a href=\"../../OpenAPI/Generator/Controller/OpenAPI.html\">OpenAPI</a></code> annotation.</p>","class_methods":[],"constructors":[],"instance_methods":[],"macros":[{"id":"open_api(yaml_op=&quot;{}&quot;)-macro","html_id":"open_api(yaml_op=&amp;quot;{}&amp;quot;)-macro","name":"open_api","doc":"This macro is used to register a class as an OpenAPI [Operation Object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#operationObject).\n\nThe argument must be a valid YAML representation of an OpenAPI operation object.\n\n```\nopan_api <<-YAML\n  tags:\n  - tag\n  summary: A brief summary of the method.\n  responses:\n    200:\n      description: Ok.\nYAML","summary":"<p>This macro is used to register a class as an OpenAPI <a href=\"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#operationObject\">Operation Object</a>.</p>","abstract":false,"args":[{"name":"yaml_op","doc":null,"default_value":"\"{}\"","external_name":"yaml_op","restriction":""}],"args_string":"(yaml_op = <span class=\"s\">&quot;{}&quot;</span>)","location":{"filename":"src/openapi-generator/controller.cr","line_number":76,"url":null},"def":{"name":"open_api","args":[{"name":"yaml_op","doc":null,"default_value":"\"{}\"","external_name":"yaml_op","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    ::OpenAPI::Generator::Controller::CONTROLLER_OPS[\"\n{{ @type }}\n\"] = YAML.parse \n{{ yaml_op }}\n\n  \n"}}],"types":[{"html_id":"openapi-generator/OpenAPI/Generator/Controller/OpenAPI","path":"OpenAPI/Generator/Controller/OpenAPI.html","kind":"annotation","full_name":"OpenAPI::Generator::Controller::OpenAPI","name":"OpenAPI","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/controller.cr","line_number":60,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator/Controller","kind":"module","full_name":"OpenAPI::Generator::Controller","name":"Controller"},"doc":"This annotation is used to register a controller method as an OpenAPI [Operation Object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#operationObject).\n\nThe argument must be a valid YAML representation of an OpenAPI operation object.\n\n```\n@[OpenAPI(<<-YAML\n  tags:\n  - tag\n  summary: A brief summary of the method.\n  responses:\n    200:\n      description: Ok.\nYAML\n)]\ndef method\nend\n```","summary":"<p>This annotation is used to register a controller method as an OpenAPI <a href=\"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#operationObject\">Operation Object</a>.</p>","class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"openapi-generator/OpenAPI/Generator/Controller/Schema","path":"OpenAPI/Generator/Controller/Schema.html","kind":"module","full_name":"OpenAPI::Generator::Controller::Schema","name":"Schema","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/controller.cr","line_number":97,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[{"html_id":"openapi-generator/OpenAPI/Generator/Controller/Schema","kind":"module","full_name":"OpenAPI::Generator::Controller::Schema","name":"Schema"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator/Controller","kind":"module","full_name":"OpenAPI::Generator::Controller","name":"Controller"},"doc":"This module contains various OpenAPI yaml syntax shortcuts.","summary":"<p>This module contains various OpenAPI yaml syntax shortcuts.</p>","class_methods":[],"constructors":[],"instance_methods":[{"id":"error(code,message=nil)-instance-method","html_id":"error(code,message=nil)-instance-method","name":"error","doc":"Generate an error response as a [response object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#responses-object-example).\n\n```\n# message is optional and defaults to a [standard error description](https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml) based on the code.\nSchema.error 400, message: \"Bad Request\"\n\n# Produces:\n\n<<-YAML\n400:\n  description: Bad Request\nYAML\n```","summary":"<p>Generate an error response as a <a href=\"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#responses-object-example\">response object</a>.</p>","abstract":false,"args":[{"name":"code","doc":null,"default_value":"","external_name":"code","restriction":""},{"name":"message","doc":null,"default_value":"nil","external_name":"message","restriction":""}],"args_string":"(code, message = <span class=\"n\">nil</span>)","args_html":"(code, message = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/controller.cr","line_number":196,"url":null},"def":{"name":"error","args":[{"name":"code","doc":null,"default_value":"","external_name":"code","restriction":""},{"name":"message","doc":null,"default_value":"nil","external_name":"message","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{code}: {\\ndescription: #{message || (HTTP::Status.new(code)).description}.\\n}\""}},{"id":"header(name,description,type=&quot;string&quot;)-instance-method","html_id":"header(name,description,type=&quot;string&quot;)-instance-method","name":"header","doc":"Generate a [header object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#header-object).\n\n```\nSchema.header \"X-Header\", \"A custom header\", type: \"string\"\n\n# Produces:\n\n<<-YAML\n\"X-Header\":\n  schema:\n    type: string\n  description: A custom header\nYAML\n```","summary":"<p>Generate a <a href=\"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#header-object\">header object</a>.</p>","abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"type","doc":null,"default_value":"\"string\"","external_name":"type","restriction":""}],"args_string":"(name, description, type = <span class=\"s\">&quot;string&quot;</span>)","args_html":"(name, description, type = <span class=\"s\">&quot;string&quot;</span>)","location":{"filename":"src/openapi-generator/controller.cr","line_number":278,"url":null},"def":{"name":"header","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"type","doc":null,"default_value":"\"string\"","external_name":"type","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{name}: {\\n  schema: {\\n    type: #{type}\\n  },\\n  description: #{description}\\n}\""}},{"id":"header_param(name,description,*,required=false,type=&quot;string&quot;)-instance-method","html_id":"header_param(name,description,*,required=false,type=&quot;string&quot;)-instance-method","name":"header_param","doc":"Generate a header [parameter object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#parameterObject).\n\n```\nSchema.header_param \"X-Header\", \"A custom header\", required: true, type: \"integer\"\n\n# Produces\n\n<<-YAML\n- in: header\n  name: \"X-Header\"\n  description: A custom header\n  required: true\n  schema:\n    type: integer\nYAML\n```","summary":"<p>Generate a header <a href=\"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#parameterObject\">parameter object</a>.</p>","abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"required","doc":null,"default_value":"false","external_name":"required","restriction":""},{"name":"type","doc":null,"default_value":"\"string\"","external_name":"type","restriction":""}],"args_string":"(name, description, *, required = <span class=\"n\">false</span>, type = <span class=\"s\">&quot;string&quot;</span>)","args_html":"(name, description, *, required = <span class=\"n\">false</span>, type = <span class=\"s\">&quot;string&quot;</span>)","location":{"filename":"src/openapi-generator/controller.cr","line_number":250,"url":null},"def":{"name":"header_param","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"required","doc":null,"default_value":"false","external_name":"required","restriction":""},{"name":"type","doc":null,"default_value":"\"string\"","external_name":"type","restriction":""}],"double_splat":null,"splat_index":2,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"- {\\n  in: header,\\n  name: #{name},\\n  description: #{description},\\n  required: #{required},\\n  schema: {\\n    type: #{type}\\n  }\\n}\""}},{"id":"qp(name,description,*,required=false,type=&quot;string&quot;)-instance-method","html_id":"qp(name,description,*,required=false,type=&quot;string&quot;)-instance-method","name":"qp","doc":"Generate a query parameter as a [parameter object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#parameterObject).\n\n```\nSchema.qp \"id\", \"Filter by id\", required: true, type: \"integer\"\n\n# Produces:\n\n<<-YAML\n- in: query\n  name: id\n  description: Filter by id\n  required: true\n  schema:\n    type: integer\nYAML\n```","summary":"<p>Generate a query parameter as a <a href=\"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#parameterObject\">parameter object</a>.</p>","abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"required","doc":null,"default_value":"false","external_name":"required","restriction":""},{"name":"type","doc":null,"default_value":"\"string\"","external_name":"type","restriction":""}],"args_string":"(name, description, *, required = <span class=\"n\">false</span>, type = <span class=\"s\">&quot;string&quot;</span>)","args_html":"(name, description, *, required = <span class=\"n\">false</span>, type = <span class=\"s\">&quot;string&quot;</span>)","location":{"filename":"src/openapi-generator/controller.cr","line_number":220,"url":null},"def":{"name":"qp","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"required","doc":null,"default_value":"false","external_name":"required","restriction":""},{"name":"type","doc":null,"default_value":"\"string\"","external_name":"type","restriction":""}],"double_splat":null,"splat_index":2,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"- {\\n  in: query,\\n  name: \\\"#{name}\\\",\\n  description: \\\"#{description}\\\",\\n  required: #{required},\\n  schema: {\\n    type: #{type}\\n  }\\n}\""}},{"id":"ref(schema,*,content_type=&quot;application/json&quot;)-instance-method","html_id":"ref(schema,*,content_type=&quot;application/json&quot;)-instance-method","name":"ref","doc":"Generates a schema reference as a [media type object](https://swagger.io/docs/specification/media-types/).\n\nUseful when dealing with objects including the `Serializable` module.\n\n```\nSchema.ref SerializableClass, content_type: \"application/x-www-form-urlencoded\"\n\n# Produces:\n\n<<-YAML\napplication/x-www-form-urlencoded:\n  schema:\n    $ref: '#/components/schemas/SerializableClass'\nYAML\n```","summary":"<p>Generates a schema reference as a <a href=\"https://swagger.io/docs/specification/media-types/\">media type object</a>.</p>","abstract":false,"args":[{"name":"schema","doc":null,"default_value":"","external_name":"schema","restriction":""},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""}],"args_string":"(schema, *, content_type = <span class=\"s\">&quot;application/json&quot;</span>)","args_html":"(schema, *, content_type = <span class=\"s\">&quot;application/json&quot;</span>)","location":{"filename":"src/openapi-generator/controller.cr","line_number":115,"url":null},"def":{"name":"ref","args":[{"name":"schema","doc":null,"default_value":"","external_name":"schema","restriction":""},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""}],"double_splat":null,"splat_index":1,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{content_type}: {\\nschema: {\\n    $ref: '#/components/schemas/#{schema.name}'\\n  }\\n}\""}},{"id":"ref_array(schema,*,content_type=&quot;application/json&quot;)-instance-method","html_id":"ref_array(schema,*,content_type=&quot;application/json&quot;)-instance-method","name":"ref_array","doc":"Generates an array of schema references as a [media type object](https://swagger.io/docs/specification/media-types/).\n\nUseful when dealing with objects including the `Serializable` module.\n\n```\nSchema.ref_array SerializableClass, content_type: \"application/x-www-form-urlencoded\"\n\n# Produces:\n\n<<-YAML\napplication/x-www-form-urlencoded:\n  schema:\n    type: array,\n    items:\n      $ref: '#/components/schemas/SerializableClass'\nYAML\n```","summary":"<p>Generates an array of schema references as a <a href=\"https://swagger.io/docs/specification/media-types/\">media type object</a>.</p>","abstract":false,"args":[{"name":"schema","doc":null,"default_value":"","external_name":"schema","restriction":""},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""}],"args_string":"(schema, *, content_type = <span class=\"s\">&quot;application/json&quot;</span>)","args_html":"(schema, *, content_type = <span class=\"s\">&quot;application/json&quot;</span>)","location":{"filename":"src/openapi-generator/controller.cr","line_number":142,"url":null},"def":{"name":"ref_array","args":[{"name":"schema","doc":null,"default_value":"","external_name":"schema","restriction":""},{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""}],"double_splat":null,"splat_index":1,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{content_type}: {\\n  schema: {\\n      type: array,\\n      items: {\\n        $ref: '#/components/schemas/#{schema.name}'\\n      }\\n  }\\n}\""}},{"id":"string_array(*,content_type=&quot;application/json&quot;)-instance-method","html_id":"string_array(*,content_type=&quot;application/json&quot;)-instance-method","name":"string_array","doc":"Generates an array of string as a [media type object](https://swagger.io/docs/specification/media-types/).\n\n```\nSchema.string_array content_type: \"application/x-www-form-urlencoded\"\n\n# Produces:\n\n<<-YAML\napplication/x-www-form-urlencoded:\n  schema:\n    type: array,\n    items:\n      type: string\nYAML\n```","summary":"<p>Generates an array of string as a <a href=\"https://swagger.io/docs/specification/media-types/\">media type object</a>.</p>","abstract":false,"args":[{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""}],"args_string":"(*, content_type = <span class=\"s\">&quot;application/json&quot;</span>)","args_html":"(*, content_type = <span class=\"s\">&quot;application/json&quot;</span>)","location":{"filename":"src/openapi-generator/controller.cr","line_number":170,"url":null},"def":{"name":"string_array","args":[{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""}],"double_splat":null,"splat_index":0,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{content_type}: {\\n  schema: {\\n      type: array,\\n      items: {\\n        type: string\\n      }\\n  }\\n}\""}}],"macros":[],"types":[]}]},{"html_id":"openapi-generator/OpenAPI/Generator/Helpers","path":"OpenAPI/Generator/Helpers.html","kind":"module","full_name":"OpenAPI::Generator::Helpers","name":"Helpers","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/helpers/action-controller.cr","line_number":153,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator","kind":"module","full_name":"OpenAPI::Generator","name":"Generator"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"openapi-generator/OpenAPI/Generator/Helpers/ActionController","path":"OpenAPI/Generator/Helpers/ActionController.html","kind":"module","full_name":"OpenAPI::Generator::Helpers::ActionController","name":"ActionController","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/helpers/action-controller.cr","line_number":153,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator/Helpers","kind":"module","full_name":"OpenAPI::Generator::Helpers","name":"Helpers"},"doc":"Helpers that can be used inside an [ActionController](https://amberframework.org/) Controller to enable inference\nand ensure that the code matches the contract defined in the generated OpenAPI document.\n\nInclude this module inside a Controller class to add various macros that you can use to make the generator\ninfer some properties of the OpenAPI declaration.\n\n- `body_as` can infer request body types and schemas.\n- `respond_with` can infer responses types and schemas.\n- `param` can infer query parameters.\n\nNOTE: Do not forget to call `bootstrap` once before calling `OpenAPI::Generator.generate`.\n\n```\nrequire \"json\"\nrequire \"openapi-generator/helpers/action-controller\"\n\nclass HelloPayloadController < ActionController::Base\n  include ::OpenAPI::Generator::Controller\n  include ::OpenAPI::Generator::Helpers::ActionController\n\n  @[OpenAPI(\n    <<-YAML\n      summary: Sends a hello payload\n    YAML\n  )]\n  def index\n    # Infers query parameters.\n    param mandatory : String, description: \"A mandatory query parameter\"\n    param optional : String?, description: \"An optional query parameter\"\n\n    # Infers request body.\n    body_as Payload?, description: \"The request payload.\"\n\n    # Infers responses.\n    respond_with 200, description: \"A hello payload.\" do\n      json Payload.new, type: Payload\n      xml \"<hello></hello>\", type: String\n    end\n    respond_with 201, description: \"A good morning message.\" do\n      text \"Good morning.\", type: String\n    end\n    respond_with 400 do\n      text \"Ouch.\", type: String\n    end\n  end\nend\n\nclass Payload\n  include JSON::Serializable\n  extend OpenAPI::Generator::Serializable\n\n  def initialize(@hello : String = \"world\")\n  end\nend\n\nActionController::Server.configure do\n  routes :api do\n    route \"get\", \"/hello\", HelloPayloadController, :index\n  end\nend\n\nOpenAPI::Generator::Helpers::ActionController.bootstrap\nOpenAPI::Generator.generate(OpenAPI::Generator::RoutesProvider::ActionController.new)\n```\n\nWill produce:\n\n```yaml\n---\nopenapi: 3.0.1\ninfo:\n  title: Test\n  version: 0.0.1\npaths:\n  /hello:\n    get:\n      summary: Sends a hello payload\n      parameters:\n      - name: mandatory\n        in: query\n        description: A mandatory query parameter\n        required: true\n        schema:\n          type: string\n      - name: optional\n        in: query\n        description: An optional query parameter\n        required: false\n        schema:\n          type: string\n      requestBody:\n        description: The request payload.\n        content:\n          application/json:\n            schema:\n              allOf:\n              - $ref: '#/components/schemas/Payload'\n        required: false\n      responses:\n        \"200\":\n          description: A hello payload?\n          content:\n            application/json:\n              schema:\n                allOf:\n                - $ref: '#/components/schemas/Payload'\n            application/xml:\n              schema:\n                type: string\n        \"201\":\n          description: A good morning message.\n          content:\n            text/plain:\n              schema:\n                type: string\n        \"400\":\n          description: Bad Request\n          content:\n            text/plain:\n              schema:\n                type: string\ncomponents:\n  schemas:\n    Payload:\n      required:\n      - hello\n      type: object\n      properties:\n        hello:\n          type: string\n  responses: {}\n  parameters: {}\n  examples: {}\n  requestBodies: {}\n  headers: {}\n  securitySchemes: {}\n  links: {}\n  callbacks: {}\n```","summary":"<p>Helpers that can be used inside an <a href=\"https://amberframework.org/\">ActionController</a> Controller to enable inference and ensure that the code matches the contract defined in the generated OpenAPI document.</p>","class_methods":[{"id":"bootstrap-class-method","html_id":"bootstrap-class-method","name":"bootstrap","doc":"Run this method exactly once before generating the schema to register all the inferred properties.","summary":"<p>Run this method exactly once before generating the schema to register all the inferred properties.</p>","abstract":false,"args":[],"args_string":"","args_html":"","location":{"filename":"src/openapi-generator/helpers/action-controller.cr","line_number":456,"url":null},"def":{"name":"bootstrap","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"::ActionController::Server.new(3000, \"127.0.0.1\")\n::OpenAPI::Generator::Helpers::ActionController::QP_LIST.each do |method, params|\n  openapi_op = ::OpenAPI::Generator::Controller::CONTROLLER_OPS[method]?\n  if openapi_op\n  else\n    next\n  end\n  if openapi_op[\"parameters\"]?\n  else\n    openapi_op.as_h[YAML::Any.new(\"parameters\")] = YAML::Any.new([] of YAML::Any)\n  end\n  params.each do |param|\n    openapi_op[\"parameters\"].as_a << (YAML.parse(param.to_yaml))\n  end\nend\n::OpenAPI::Generator::Helpers::ActionController::CONTROLLER_RESPONSES.each do |method, responses|\n  op = ::OpenAPI::Generator::Controller::CONTROLLER_OPS[method]?\n  if op\n  else\n    next\n  end\n  responses.each do |code, values|\n    response, schemas = values\n    schemas.try(&.each do |content_type, schema|\n      if response.content\n      else\n        response.content = {} of String => OpenAPI::MediaType\n      end\n      response.content.try(&.[]=(content_type, ::OpenAPI::MediaType.new(schema: schema)))\n    end)\n    if op[\"responses\"]?\n    else\n      op.as_h[YAML::Any.new(\"responses\")] = YAML::Any.new(Hash(YAML::Any, YAML::Any).new)\n    end\n    original_yaml_response = op[\"responses\"].as_h.find do |__arg3|\n      key = __arg3[0]\n      value = __arg3[1]\n      key.raw.to_s == code.to_s\n    end\n    if !original_yaml_response\n      op[\"responses\"].as_h[YAML::Any.new(code.to_s)] = YAML.parse(response.to_yaml)\n    else\n      if original_yaml_response[1][\"description\"]?\n      else\n        original_yaml_response[1].as_h[YAML::Any.new(\"description\")] = YAML::Any.new(\"\")\n      end\n      original_response = ::OpenAPI::Response.from_json(original_yaml_response[1].to_json)\n      op[\"responses\"].as_h[YAML::Any.new(code.to_s)] = YAML.parse(::OpenAPI::Response.new(description: response.description || original_response.description, headers: original_response.headers || response.headers, links: original_response.links || response.links, content: original_response.content || response.content).to_yaml)\n    end\n  end\nend\n::OpenAPI::Generator::Helpers::ActionController::BODY_LIST.each do |method, value|\n  op = ::OpenAPI::Generator::Controller::CONTROLLER_OPS[method]?\n  if op\n  else\n    next\n  end\n  request_body, schemas = value\n  schemas.each do |content_type, schema|\n    request_body.content.try(&.[]=(content_type, ::OpenAPI::MediaType.new(schema: schema)))\n  end\n  if op[\"requestBody\"]?\n  else\n    op.as_h[YAML::Any.new(\"requestBody\")] = YAML.parse(request_body.to_yaml)\n  end\nend\n"}}],"constructors":[],"instance_methods":[],"macros":[{"id":"body_as(type,description=nil,content_type=&quot;application/json&quot;,constructor=:from_json)-macro","html_id":"body_as(type,description=nil,content_type=&amp;quot;application/json&amp;quot;,constructor=:from_json)-macro","name":"body_as","doc":"Extracts and serialize the body from the request and registers it in the OpenAPI operation.\n\n```\n# This will try to case the body as a SomeClass using the SomeClass.new method and assuming that the payload is a json.\nbody_as SomeClass, description: \"Some payload.\", content_type: \"application/json\", constructor: new\n# The content_type, constructor and description can be omitted.\nbody_as SomeClass\n```","summary":"<p>Extracts and serialize the body from the request and registers it in the OpenAPI operation.</p>","abstract":false,"args":[{"name":"type","doc":null,"default_value":"","external_name":"type","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""},{"name":"constructor","doc":null,"default_value":":from_json","external_name":"constructor","restriction":""}],"args_string":"(type, description = <span class=\"n\">nil</span>, content_type = <span class=\"s\">&quot;application/json&quot;</span>, constructor = <span class=\"n\">:from_json</span>)","location":{"filename":"src/openapi-generator/helpers/action-controller.cr","line_number":248,"url":null},"def":{"name":"body_as","args":[{"name":"type","doc":null,"default_value":"","external_name":"type","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""},{"name":"constructor","doc":null,"default_value":":from_json","external_name":"constructor","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    \n{% non_nil_type = type.resolve.union_types.reject do |t|\n  t == Nil\nend[0] %}\n\n    body_as(\n      request_body: ::OpenAPI::Generator::Helpers::ActionController.init_openapi_request_body(\n        description: \n{{ description }}\n,\n        required: \n{{ !type.resolve.nilable? }}\n\n      ),\n      schema: \n{{ non_nil_type }}\n.to_openapi_schema,\n      content_type: \n{{ content_type }}\n\n    )\n    \n%content\n = request.body.try &.gets_to_end\n    if \n%content\n\n      ::\n{{ non_nil_type }}\n.\n{{ constructor.id }}\n(\n%content\n)\n    \nend\n  \n"}},{"id":"param(declaration,description,multiple=false,schema=nil,**args)-macro","html_id":"param(declaration,description,multiple=false,schema=nil,**args)-macro","name":"param","doc":"Fetch a query parameter and register it in the OpenAPI operation related to the controller method.\n\n```\nparam name : String = \"default\", \"A user name.\"\n```","summary":"<p>Fetch a query parameter and register it in the OpenAPI operation related to the controller method.</p>","abstract":false,"args":[{"name":"declaration","doc":null,"default_value":"","external_name":"declaration","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"multiple","doc":null,"default_value":"false","external_name":"multiple","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"args_string":"(declaration, description, multiple = <span class=\"n\">false</span>, schema = <span class=\"n\">nil</span>, **args)","location":{"filename":"src/openapi-generator/helpers/action-controller.cr","line_number":173,"url":null},"def":{"name":"param","args":[{"name":"declaration","doc":null,"default_value":"","external_name":"declaration","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"multiple","doc":null,"default_value":"false","external_name":"multiple","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"double_splat":{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""},"splat_index":null,"block_arg":null,"visibility":"Public","body":"    \n{% name = declaration.var.stringify %}\n\n\n    \n{% default_value = (declaration.value || (declaration.value == false)) ? declaration.value : nil %}\n\n\n    \n{% raw_type = declaration.type ? declaration.type.resolve : String %}\n\n    \n{% nillable = !(raw_type.union_types.includes?(Nil)) %}\n\n    \n{% type = raw_type.union_types.reject(&.==(Nil)).first %}\n\n\n    _params(\n      name: \n{{ name }}\n,\n      default_value: \n{{ default_value }}\n,\n      type: \n{{ raw_type }}\n,\n      param: ::OpenAPI::Generator::Helpers::ActionController.init_openapi_parameter(\n        name: \n{{ name }}\n,\n        \"in\": \"query\",\n        required: \n{{ nillable }}\n,\n        schema: \n{% if schema %}{{ schema }}{% else %}{% if multiple %}::OpenAPI::Schema.new(\n          type: \"array\",\n          items: {{ type }}.to_openapi_schema,\n        ){% else %}{{ type }}.to_openapi_schema{% end %}{% end %}\n,\n        description: \n{{ description }}\n,\n        \n{{ **args }}\n\n      ),\n      required: \n{{ nillable }}\n,\n      multiple: \n{{ multiple }}\n\n    )\n  \n"}},{"id":"render(status_code=:ok,head=Nop,json=Nop,yaml=Nop,xml=Nop,html=Nop,text=Nop,binary=Nop,template=Nop,partial=Nop,layout=nil,description=nil,headers=nil,links=nil,type=nil,schema=nil)-macro","html_id":"render(status_code=:ok,head=Nop,json=Nop,yaml=Nop,xml=Nop,html=Nop,text=Nop,binary=Nop,template=Nop,partial=Nop,layout=nil,description=nil,headers=nil,links=nil,type=nil,schema=nil)-macro","name":"render","doc":"Same as the ActionController method with automatic response inference.","summary":"<p>Same as the ActionController method with automatic response inference.</p>","abstract":false,"args":[{"name":"status_code","doc":null,"default_value":":ok","external_name":"status_code","restriction":""},{"name":"head","doc":null,"default_value":"Nop","external_name":"head","restriction":""},{"name":"json","doc":null,"default_value":"Nop","external_name":"json","restriction":""},{"name":"yaml","doc":null,"default_value":"Nop","external_name":"yaml","restriction":""},{"name":"xml","doc":null,"default_value":"Nop","external_name":"xml","restriction":""},{"name":"html","doc":null,"default_value":"Nop","external_name":"html","restriction":""},{"name":"text","doc":null,"default_value":"Nop","external_name":"text","restriction":""},{"name":"binary","doc":null,"default_value":"Nop","external_name":"binary","restriction":""},{"name":"template","doc":null,"default_value":"Nop","external_name":"template","restriction":""},{"name":"partial","doc":null,"default_value":"Nop","external_name":"partial","restriction":""},{"name":"layout","doc":null,"default_value":"nil","external_name":"layout","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""},{"name":"type","doc":null,"default_value":"nil","external_name":"type","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"args_string":"(status_code = <span class=\"n\">:ok</span>, head = <span class=\"t\">Nop</span>, json = <span class=\"t\">Nop</span>, yaml = <span class=\"t\">Nop</span>, xml = <span class=\"t\">Nop</span>, html = <span class=\"t\">Nop</span>, text = <span class=\"t\">Nop</span>, binary = <span class=\"t\">Nop</span>, template = <span class=\"t\">Nop</span>, partial = <span class=\"t\">Nop</span>, layout = <span class=\"n\">nil</span>, description = <span class=\"n\">nil</span>, headers = <span class=\"n\">nil</span>, links = <span class=\"n\">nil</span>, type = <span class=\"n\">nil</span>, schema = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/helpers/action-controller.cr","line_number":417,"url":null},"def":{"name":"render","args":[{"name":"status_code","doc":null,"default_value":":ok","external_name":"status_code","restriction":""},{"name":"head","doc":null,"default_value":"Nop","external_name":"head","restriction":""},{"name":"json","doc":null,"default_value":"Nop","external_name":"json","restriction":""},{"name":"yaml","doc":null,"default_value":"Nop","external_name":"yaml","restriction":""},{"name":"xml","doc":null,"default_value":"Nop","external_name":"xml","restriction":""},{"name":"html","doc":null,"default_value":"Nop","external_name":"html","restriction":""},{"name":"text","doc":null,"default_value":"Nop","external_name":"text","restriction":""},{"name":"binary","doc":null,"default_value":"Nop","external_name":"binary","restriction":""},{"name":"template","doc":null,"default_value":"Nop","external_name":"template","restriction":""},{"name":"partial","doc":null,"default_value":"Nop","external_name":"partial","restriction":""},{"name":"layout","doc":null,"default_value":"nil","external_name":"layout","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""},{"name":"type","doc":null,"default_value":"nil","external_name":"type","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    \n{% status = status_code.is_a?(SymbolLiteral) ? STATUS_CODES[status_code] : status_code %}\n\n\n    render(\n      status_code: \n{{ status }}\n, head: \n{{ head }}\n, json: \n{{ json }}\n, yaml: \n{{ yaml }}\n, xml: \n{{ xml }}\n, html: \n{{ html }}\n, text: \n{{ text }}\n, binary: \n{{ binary }}\n, template: \n{{ template }}\n, partial: \n{{ partial }}\n, layout: \n{{ layout }}\n, \n      response: ::OpenAPI::Generator::Helpers::ActionController.init_openapi_response(\n        description: \n{{ description }}\n,\n        code: \n{{ status }}\n,\n        headers: \n{{ headers }}\n,\n        links: \n{{ links }}\n\n      ), type: \n{{ type }}\n, schema: \n{{ schema }}\n)\n  \n"}},{"id":"respond_with(code=200,description=nil,headers=nil,links=nil,&)-macro","html_id":"respond_with(code=200,description=nil,headers=nil,links=nil,&amp;)-macro","name":"respond_with","doc":"Same as the ActionController method with automatic response inference.","summary":"<p>Same as the ActionController method with automatic response inference.</p>","abstract":false,"args":[{"name":"code","doc":null,"default_value":"200","external_name":"code","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"args_string":"(code = <span class=\"n\">200</span>, description = <span class=\"n\">nil</span>, headers = <span class=\"n\">nil</span>, links = <span class=\"n\">nil</span>, &)","location":{"filename":"src/openapi-generator/helpers/action-controller.cr","line_number":394,"url":null},"def":{"name":"respond_with","args":[{"name":"code","doc":null,"default_value":"200","external_name":"code","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},"visibility":"Public","body":"    respond_with(code: \n{{ code }}\n, response: ::OpenAPI::Generator::Helpers::ActionController.init_openapi_response(\n      description: \n{{ description }}\n,\n      code: \n{{ code }}\n,\n      headers: \n{{ headers }}\n,\n      links: \n{{ links }}\n\n    )) do\n      \n{{ yield }}\n\n    \nend\n  \n"}},{"id":"respond_without_body(code=200,description=nil,headers=nil,links=nil)-macro","html_id":"respond_without_body(code=200,description=nil,headers=nil,links=nil)-macro","name":"respond_without_body","doc":"Same as the ActionController method but without specifying any content and with automatic response inference.","summary":"<p>Same as the ActionController method but without specifying any content and with automatic response inference.</p>","abstract":false,"args":[{"name":"code","doc":null,"default_value":"200","external_name":"code","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"args_string":"(code = <span class=\"n\">200</span>, description = <span class=\"n\">nil</span>, headers = <span class=\"n\">nil</span>, links = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/helpers/action-controller.cr","line_number":431,"url":null},"def":{"name":"respond_without_body","args":[{"name":"code","doc":null,"default_value":"200","external_name":"code","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    respond_without_body(code: \n{{ code }}\n, response: ::OpenAPI::Generator::Helpers::ActionController.init_openapi_response(\n      description: \n{{ description }}\n,\n      code: \n{{ code }}\n,\n      headers: \n{{ headers }}\n,\n      links: \n{{ links }}\n\n    ))\n  \n"}}],"types":[]},{"html_id":"openapi-generator/OpenAPI/Generator/Helpers/Amber","path":"OpenAPI/Generator/Helpers/Amber.html","kind":"module","full_name":"OpenAPI::Generator::Helpers::Amber","name":"Amber","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/helpers/amber.cr","line_number":143,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator/Helpers","kind":"module","full_name":"OpenAPI::Generator::Helpers","name":"Helpers"},"doc":"Helpers that can be used inside an [Amber](https://amberframework.org/) Controller to enable inference\nand ensure that the code matches the contract defined in the generated OpenAPI document.\n\nInclude this module inside a Controller class to add various macros that you can use to make the generator\ninfer some properties of the OpenAPI declaration.\n\n- `body_as` can infer request body types and schemas.\n- `respond_with` can infer responses types and schemas.\n- `query_params` can infer query parameters.\n\nNOTE: Do not forget to call `bootstrap` once before calling `OpenAPI::Generator.generate`.\n\n```\nrequire \"json\"\nrequire \"openapi-generator/helpers/amber\"\n\nclass HelloPayloadController < Amber::Controller::Base\n  include ::OpenAPI::Generator::Controller\n  include ::OpenAPI::Generator::Helpers::Amber\n\n  @[OpenAPI(\n    <<-YAML\n      summary: Sends a hello payload\n    YAML\n  )]\n  def index\n    # Infers query parameters.\n    query_params \"mandatory\", description: \"A mandatory query parameter\"\n    query_params? \"optional\", description: \"An optional query parameter\"\n\n    # Infers request body.\n    body_as Payload?, description: \"The request payload.\"\n\n    # Infers responses.\n    respond_with 200, description: \"A hello payload.\" do\n      json Payload.new, type: Payload\n      xml \"<hello></hello>\", type: String\n    end\n    respond_with 201, description: \"A good morning message.\" do\n      text \"Good morning.\", type: String\n    end\n    respond_with 400 do\n      text \"Ouch.\", type: String\n    end\n  end\nend\n\nclass Payload\n  include JSON::Serializable\n  extend OpenAPI::Generator::Serializable\n\n  def initialize(@hello : String = \"world\")\n  end\nend\n\nAmber::Server.configure do\n  routes :api do\n    route \"get\", \"/hello\", HelloPayloadController, :index\n  end\nend\n\nOpenAPI::Generator::Helpers::Amber.bootstrap\nOpenAPI::Generator.generate(OpenAPI::Generator::RoutesProvider::Amber.new)\n```\n\nWill produce:\n\n```yaml\n---\nopenapi: 3.0.1\ninfo:\n  title: Test\n  version: 0.0.1\npaths:\n  /hello:\n    get:\n      summary: Sends a hello payload\n      parameters:\n      - name: mandatory\n        in: query\n        description: A mandatory query parameter\n        required: true\n        schema:\n          type: string\n      - name: optional\n        in: query\n        description: An optional query parameter\n        required: false\n        schema:\n          type: string\n      requestBody:\n        description: The request payload.\n        content:\n          application/json:\n            schema:\n              allOf:\n              - $ref: '#/components/schemas/Payload'\n        required: false\n      responses:\n        \"200\":\n          description: A hello payload?\n          content:\n            application/json:\n              schema:\n                allOf:\n                - $ref: '#/components/schemas/Payload'\n            application/xml:\n              schema:\n                type: string\n        \"201\":\n          description: A good morning message.\n          content:\n            text/plain:\n              schema:\n                type: string\n        \"400\":\n          description: Bad Request\n          content:\n            text/plain:\n              schema:\n                type: string\ncomponents:\n  schemas:\n    Payload:\n      required:\n      - hello\n      type: object\n      properties:\n        hello:\n          type: string\n  responses: {}\n  parameters: {}\n  examples: {}\n  requestBodies: {}\n  headers: {}\n  securitySchemes: {}\n  links: {}\n  callbacks: {}\n```","summary":"<p>Helpers that can be used inside an <a href=\"https://amberframework.org/\">Amber</a> Controller to enable inference and ensure that the code matches the contract defined in the generated OpenAPI document.</p>","class_methods":[{"id":"bootstrap-class-method","html_id":"bootstrap-class-method","name":"bootstrap","doc":"Run this method exactly once before generating the schema to register all the inferred properties.","summary":"<p>Run this method exactly once before generating the schema to register all the inferred properties.</p>","abstract":false,"args":[],"args_string":"","args_html":"","location":{"filename":"src/openapi-generator/helpers/amber.cr","line_number":371,"url":null},"def":{"name":"bootstrap","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"::OpenAPI::Generator::Helpers::Amber::QP_LIST.each do |method, params|\n  openapi_op = ::OpenAPI::Generator::Controller::CONTROLLER_OPS[method]?\n  if openapi_op\n  else\n    next\n  end\n  if openapi_op[\"parameters\"]?\n  else\n    openapi_op.as_h[YAML::Any.new(\"parameters\")] = YAML::Any.new([] of YAML::Any)\n  end\n  params.each do |param|\n    openapi_op[\"parameters\"].as_a << (YAML.parse(param.to_yaml))\n  end\nend\n::OpenAPI::Generator::Helpers::Amber::CONTROLLER_RESPONSES.each do |method, responses|\n  op = ::OpenAPI::Generator::Controller::CONTROLLER_OPS[method]?\n  if op\n  else\n    next\n  end\n  responses.each do |__arg0|\n    code = __arg0[0]\n    values = __arg0[1]\n    response, schemas = values\n    schemas.try(&.each do |content_type, schema|\n      if response.content\n      else\n        response.content = {} of String => OpenAPI::MediaType\n      end\n      response.content.try(&.[]=(content_type, ::OpenAPI::MediaType.new(schema: schema)))\n    end)\n    if op[\"responses\"]?\n    else\n      op.as_h[YAML::Any.new(\"responses\")] = YAML::Any.new(Hash(YAML::Any, YAML::Any).new)\n    end\n    original_yaml_response = op[\"responses\"].as_h.find do |__arg3|\n      key = __arg3[0]\n      value = __arg3[1]\n      key.raw.to_s == code.to_s\n    end\n    if !original_yaml_response\n      op[\"responses\"].as_h[YAML::Any.new(code.to_s)] = YAML.parse(response.to_yaml)\n    else\n      if original_yaml_response[1][\"description\"]?\n      else\n        original_yaml_response[1].as_h[YAML::Any.new(\"description\")] = YAML::Any.new(\"\")\n      end\n      original_response = ::OpenAPI::Response.from_json(original_yaml_response[1].to_json)\n      op[\"responses\"].as_h[YAML::Any.new(code.to_s)] = YAML.parse(::OpenAPI::Response.new(description: response.description || original_response.description, headers: original_response.headers || response.headers, links: original_response.links || response.links, content: original_response.content || response.content).to_yaml)\n    end\n  end\nend\n::OpenAPI::Generator::Helpers::Amber::BODY_LIST.each do |method, value|\n  op = ::OpenAPI::Generator::Controller::CONTROLLER_OPS[method]?\n  if op\n  else\n    next\n  end\n  request_body, schemas = value\n  schemas.each do |content_type, schema|\n    request_body.content.try(&.[]=(content_type, ::OpenAPI::MediaType.new(schema: schema)))\n  end\n  if op[\"requestBody\"]?\n  else\n    op.as_h[YAML::Any.new(\"requestBody\")] = YAML.parse(request_body.to_yaml)\n  end\nend\n"}}],"constructors":[],"instance_methods":[],"macros":[{"id":"body_as(type,description=nil,content_type=&quot;application/json&quot;,constructor=:from_json)-macro","html_id":"body_as(type,description=nil,content_type=&amp;quot;application/json&amp;quot;,constructor=:from_json)-macro","name":"body_as","doc":"Extracts and serialize the body from the request and registers it in the OpenAPI operation.\n\n```\n# This will try to case the body as a SomeClass using the SomeClass.new method and assuming that the payload is a json.\nbody_as SomeClass, description: \"Some payload.\", content_type: \"application/json\", constructor: new\n# The content_type, constructor and description can be omitted.\nbody_as SomeClass\n```","summary":"<p>Extracts and serialize the body from the request and registers it in the OpenAPI operation.</p>","abstract":false,"args":[{"name":"type","doc":null,"default_value":"","external_name":"type","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""},{"name":"constructor","doc":null,"default_value":":from_json","external_name":"constructor","restriction":""}],"args_string":"(type, description = <span class=\"n\">nil</span>, content_type = <span class=\"s\">&quot;application/json&quot;</span>, constructor = <span class=\"n\">:from_json</span>)","location":{"filename":"src/openapi-generator/helpers/amber.cr","line_number":243,"url":null},"def":{"name":"body_as","args":[{"name":"type","doc":null,"default_value":"","external_name":"type","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""},{"name":"constructor","doc":null,"default_value":":from_json","external_name":"constructor","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    \n{% non_nil_type = type.resolve.union_types.reject do |t|\n  t == Nil\nend[0] %}\n\n    body_as(\n      request_body: ::OpenAPI::Generator::Helpers::Amber.init_openapi_request_body(\n        description: \n{{ description }}\n,\n        required: \n{{ !type.resolve.nilable? }}\n\n      ),\n      schema: \n{{ non_nil_type }}\n.to_openapi_schema,\n      content_type: \n{{ content_type }}\n\n    )\n    \n%content\n = request.body.try &.gets_to_end\n    if \n%content\n\n      ::\n{{ non_nil_type }}\n.\n{{ constructor.id }}\n(\n%content\n)\n    \nend\n  \n"}},{"id":"query_params(name,description,multiple=false,schema=nil,**args)-macro","html_id":"query_params(name,description,multiple=false,schema=nil,**args)-macro","name":"query_params","doc":"Fetch a query parameter and register it in the OpenAPI operation related to the controller method.\n\n```\nquery_params \"name\", \"A user name.\"\n```","summary":"<p>Fetch a query parameter and register it in the OpenAPI operation related to the controller method.</p>","abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"multiple","doc":null,"default_value":"false","external_name":"multiple","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"args_string":"(name, description, multiple = <span class=\"n\">false</span>, schema = <span class=\"n\">nil</span>, **args)","location":{"filename":"src/openapi-generator/helpers/amber.cr","line_number":163,"url":null},"def":{"name":"query_params","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"multiple","doc":null,"default_value":"false","external_name":"multiple","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"double_splat":{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""},"splat_index":null,"block_arg":null,"visibility":"Public","body":"    _query_params(\n      name: \n{{ name }}\n,\n      param: ::OpenAPI::Generator::Helpers::Amber.init_openapi_parameter(\n        name: \n{{ name }}\n,\n        \"in\": \"query\",\n        required: true,\n        schema: \n{% if schema %}{{ schema }}{% else %}{% if multiple %}::OpenAPI::Schema.new(\n          type: \"array\",\n          items: ::OpenAPI::Schema.new(\n            type: \"string\"\n          )\n        ){% else %}::OpenAPI::Schema.new(\n          type: \"string\",\n        ){% end %}{% end %}\n,\n        description: \n{{ description }}\n,\n        \n{{ **args }}\n\n      ),\n      required: true,\n      multiple: \n{{ multiple }}\n\n    )\n  \n"}},{"id":"query_params?(name,description,multiple=false,schema=nil,**args)-macro","html_id":"query_params?(name,description,multiple=false,schema=nil,**args)-macro","name":"query_params?","doc":"Fetch an optional query parameter and register it in the OpenAPI operation related to the controller method.\n\n```\nquery_params? \"name[]\", \"One or multiple user names. (optional)\", multiple = true\n```","summary":"<p>Fetch an optional query parameter and register it in the OpenAPI operation related to the controller method.</p>","abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"multiple","doc":null,"default_value":"false","external_name":"multiple","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"args_string":"(name, description, multiple = <span class=\"n\">false</span>, schema = <span class=\"n\">nil</span>, **args)","location":{"filename":"src/openapi-generator/helpers/amber.cr","line_number":191,"url":null},"def":{"name":"query_params?","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""},{"name":"multiple","doc":null,"default_value":"false","external_name":"multiple","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"double_splat":{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""},"splat_index":null,"block_arg":null,"visibility":"Public","body":"    _query_params(\n      name: \n{{ name }}\n,\n      param: ::OpenAPI::Generator::Helpers::Amber.init_openapi_parameter(\n        name: \n{{ name }}\n,\n        \"in\": \"query\",\n        required: false,\n        schema: \n{% if schema %}{{ schema }}{% else %}{% if multiple %}::OpenAPI::Schema.new(\n          type: \"array\",\n          items: ::OpenAPI::Schema.new(\n            type: \"string\"\n          )\n        ){% else %}::OpenAPI::Schema.new(\n          type: \"string\",\n        ){% end %}{% end %}\n,\n        description: \n{{ description }}\n,\n        \n{{ **args }}\n\n      ),\n      required: false,\n      multiple: \n{{ multiple }}\n\n    )\n  \n"}},{"id":"respond_with(code=200,description=nil,headers=nil,links=nil,&)-macro","html_id":"respond_with(code=200,description=nil,headers=nil,links=nil,&amp;)-macro","name":"respond_with","doc":"Same as the [Amber method](https://docs.amberframework.org/amber/guides/controllers/respond-with) with automatic response inference.","summary":"<p>Same as the <a href=\"https://docs.amberframework.org/amber/guides/controllers/respond-with\">Amber method</a> with automatic response inference.</p>","abstract":false,"args":[{"name":"code","doc":null,"default_value":"200","external_name":"code","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"args_string":"(code = <span class=\"n\">200</span>, description = <span class=\"n\">nil</span>, headers = <span class=\"n\">nil</span>, links = <span class=\"n\">nil</span>, &)","location":{"filename":"src/openapi-generator/helpers/amber.cr","line_number":323,"url":null},"def":{"name":"respond_with","args":[{"name":"code","doc":null,"default_value":"200","external_name":"code","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":{"name":"","doc":null,"default_value":"","external_name":"","restriction":""},"visibility":"Public","body":"    respond_with(code: \n{{ code }}\n, response: ::OpenAPI::Generator::Helpers::Amber.init_openapi_response(\n      description: \n{{ description }}\n,\n      code: \n{{ code }}\n,\n      headers: \n{{ headers }}\n,\n      links: \n{{ links }}\n\n    )) do\n      \n{{ yield }}\n\n    \nend\n  \n"}},{"id":"respond_without_body(code=200,description=nil,headers=nil,links=nil)-macro","html_id":"respond_without_body(code=200,description=nil,headers=nil,links=nil)-macro","name":"respond_without_body","doc":"Same as the [Amber method](https://docs.amberframework.org/amber/guides/controllers/respond-with) but without specifying any content and with automatic response inference.","summary":"<p>Same as the <a href=\"https://docs.amberframework.org/amber/guides/controllers/respond-with\">Amber method</a> but without specifying any content and with automatic response inference.</p>","abstract":false,"args":[{"name":"code","doc":null,"default_value":"200","external_name":"code","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"args_string":"(code = <span class=\"n\">200</span>, description = <span class=\"n\">nil</span>, headers = <span class=\"n\">nil</span>, links = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/helpers/amber.cr","line_number":346,"url":null},"def":{"name":"respond_without_body","args":[{"name":"code","doc":null,"default_value":"200","external_name":"code","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    respond_without_body(code: \n{{ code }}\n, response: ::OpenAPI::Generator::Helpers::Amber.init_openapi_response(\n      description: \n{{ description }}\n,\n      code: \n{{ code }}\n,\n      headers: \n{{ headers }}\n,\n      links: \n{{ links }}\n\n    ))\n  \n"}}],"types":[]},{"html_id":"openapi-generator/OpenAPI/Generator/Helpers/Lucky","path":"OpenAPI/Generator/Helpers/Lucky.html","kind":"module","full_name":"OpenAPI::Generator::Helpers::Lucky","name":"Lucky","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/helpers/lucky.cr","line_number":5,"url":null},{"filename":"src/openapi-generator/helpers/lucky/body.cr","line_number":1,"url":null},{"filename":"src/openapi-generator/helpers/lucky/query_params.cr","line_number":1,"url":null},{"filename":"src/openapi-generator/helpers/lucky/responses.cr","line_number":1,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator/Helpers","kind":"module","full_name":"OpenAPI::Generator::Helpers","name":"Helpers"},"doc":null,"summary":null,"class_methods":[{"id":"bootstrap-class-method","html_id":"bootstrap-class-method","name":"bootstrap","doc":"Run this method exactly once before generating the schema to register all the inferred properties.","summary":"<p>Run this method exactly once before generating the schema to register all the inferred properties.</p>","abstract":false,"args":[],"args_string":"","args_html":"","location":{"filename":"src/openapi-generator/helpers/lucky.cr","line_number":12,"url":null},"def":{"name":"bootstrap","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if false\n  io = IO::Memory.new\n  response = HTTP::Server::Response.new(io)\n  request = HTTP::Request.new(method: \"get\", resource: \"/\")\n  context = HTTP::Server::Context.new(request: request, response: response)\n  ::Lucky::RouteHandler.new.call(context)\nend\n::OpenAPI::Generator::Helpers::Lucky::QP_LIST.each do |key, params|\n  openapi_op = ::OpenAPI::Generator::Controller::CONTROLLER_OPS[key]?\n  if openapi_op\n  else\n    next\n  end\n  if openapi_op[\"parameters\"]?\n  else\n    openapi_op.as_h[YAML::Any.new(\"parameters\")] = YAML::Any.new([] of YAML::Any)\n  end\n  params.each do |param|\n    openapi_op[\"parameters\"].as_a << (YAML.parse(param.to_yaml))\n  end\nend\n::OpenAPI::Generator::Helpers::Lucky::CONTROLLER_RESPONSES.each do |key, responses|\n  op = ::OpenAPI::Generator::Controller::CONTROLLER_OPS[key]?\n  if op\n  else\n    next\n  end\n  responses.each do |__arg0|\n    code = __arg0[0]\n    values = __arg0[1]\n    response, schemas = values\n    schemas.try(&.each do |content_type, schema|\n      if response.content\n      else\n        response.content = {} of String => ::OpenAPI::MediaType\n      end\n      response.content.try(&.[]=(content_type, ::OpenAPI::MediaType.new(schema: schema)))\n    end)\n    if op[\"responses\"]?\n    else\n      op.as_h[YAML::Any.new(\"responses\")] = YAML::Any.new(Hash(YAML::Any, YAML::Any).new)\n    end\n    original_yaml_response = op[\"responses\"].as_h.find do |__arg3|\n      key = __arg3[0]\n      value = __arg3[1]\n      key.raw.to_s == code.to_s\n    end\n    if !original_yaml_response\n      op[\"responses\"].as_h[YAML::Any.new(code.to_s)] = YAML.parse(response.to_yaml)\n    else\n      if original_yaml_response[1][\"description\"]?\n      else\n        original_yaml_response[1].as_h[YAML::Any.new(\"description\")] = YAML::Any.new(\"\")\n      end\n      original_response = ::OpenAPI::Response.from_json(original_yaml_response[1].to_json)\n      op[\"responses\"].as_h[YAML::Any.new(code.to_s)] = YAML.parse(::OpenAPI::Response.new(description: response.description || original_response.description, headers: original_response.headers || response.headers, links: original_response.links || response.links, content: original_response.content || response.content).to_yaml)\n    end\n  end\nend\n::OpenAPI::Generator::Helpers::Lucky::BODY_LIST.each do |key, value|\n  op = ::OpenAPI::Generator::Controller::CONTROLLER_OPS[key]?\n  if op\n  else\n    next\n  end\n  request_body, schemas = value\n  schemas.each do |content_type, schema|\n    request_body.content.try(&.[]=(content_type, ::OpenAPI::MediaType.new(schema: schema)))\n  end\n  if op[\"requestBody\"]?\n  else\n    op.as_h[YAML::Any.new(\"requestBody\")] = YAML.parse(request_body.to_yaml)\n  end\nend\n"}}],"constructors":[],"instance_methods":[],"macros":[{"id":"body_as(type,description=nil,content_type=&quot;application/json&quot;,constructor=:from_json)-macro","html_id":"body_as(type,description=nil,content_type=&amp;quot;application/json&amp;quot;,constructor=:from_json)-macro","name":"body_as","doc":"Extracts and serialize the body from the request and registers it in the OpenAPI operation.\n\n```\n# This will try to case the body as a SomeClass using the SomeClass.new method and assuming that the payload is a json.\nbody_as SomeClass, description: \"Some payload.\", content_type: \"application/json\", constructor: from_json\n# The content_type, constructor and description can be omitted.\nbody_as SomeClass\n```","summary":"<p>Extracts and serialize the body from the request and registers it in the OpenAPI operation.</p>","abstract":false,"args":[{"name":"type","doc":null,"default_value":"","external_name":"type","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""},{"name":"constructor","doc":null,"default_value":":from_json","external_name":"constructor","restriction":""}],"args_string":"(type, description = <span class=\"n\">nil</span>, content_type = <span class=\"s\">&quot;application/json&quot;</span>, constructor = <span class=\"n\">:from_json</span>)","location":{"filename":"src/openapi-generator/helpers/lucky/body.cr","line_number":13,"url":null},"def":{"name":"body_as","args":[{"name":"type","doc":null,"default_value":"","external_name":"type","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"content_type","doc":null,"default_value":"\"application/json\"","external_name":"content_type","restriction":""},{"name":"constructor","doc":null,"default_value":":from_json","external_name":"constructor","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    \n{% not_nil_type = type.resolve.union_types.reject do |t|\n  t == Nil\nend[0] %}\n\n    _body_as(\n      request_body: ::OpenAPI::Generator::Helpers::Lucky._init_openapi_request_body(\n        description: \n{{ description }}\n,\n        required: \n{{ !type.resolve.nilable? }}\n\n      ),\n      schema: \n{{ not_nil_type }}\n.to_openapi_schema,\n      content_type: \n{{ content_type }}\n\n    )\n    if \n%content\n = request.body.try &.gets_to_end\n      ::\n{{ not_nil_type }}\n.\n{{ constructor.id }}\n(\n%content\n)\n    \nend\n  \n"}},{"id":"body_as!(*args,**named_args)-macro","html_id":"body_as!(*args,**named_args)-macro","name":"body_as!","doc":"Same as `body_as` but will raise if the body is missing or badly formatted.","summary":"<p>Same as <code><a href=\"../../../OpenAPI/Generator/Helpers/Lucky.html#body_as(type,description=nil,content_type=&quot;application/json&quot;,constructor=:from_json)-macro\">body_as</a></code> but will raise if the body is missing or badly formatted.</p>","abstract":false,"args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"args_string":"(*args, **named_args)","location":{"filename":"src/openapi-generator/helpers/lucky/body.cr","line_number":39,"url":null},"def":{"name":"body_as!","args":[{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""}],"double_splat":{"name":"named_args","doc":null,"default_value":"","external_name":"named_args","restriction":""},"splat_index":0,"block_arg":null,"visibility":"Public","body":"    \n%content\n = body_as(\n{{ *args }}\n, \n{{ **named_args }}\n)\n    if !\n%content\n\n      raise Lucky::Error.new \"Missing body.\"\n    \nend\n    \n%content\n.not_nil!\n  \n"}},{"id":"head(status,description=nil,headers=nil,links=nil)-macro","html_id":"head(status,description=nil,headers=nil,links=nil)-macro","name":"head","doc":"Declare a head response.","summary":"<p>Declare a head response.</p>","abstract":false,"args":[{"name":"status","doc":null,"default_value":"","external_name":"status","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"args_string":"(status, description = <span class=\"n\">nil</span>, headers = <span class=\"n\">nil</span>, links = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/helpers/lucky/responses.cr","line_number":27,"url":null},"def":{"name":"head","args":[{"name":"status","doc":null,"default_value":"","external_name":"status","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    _controller_response(\n      schema: nil,\n      code: \n{{ status }}\n,\n      response: ::OpenAPI::Generator::Helpers::Lucky._init_openapi_response(\n        description: \n{{ description }}\n,\n        code: \n{{ status }}\n,\n        headers: \n{{ headers }}\n,\n        links: \n{{ links }}\n\n      ),\n      content_type: nil\n    )\n    self.head(status: \n{{ status }}\n)\n  \n"}},{"id":"json(body,status=200,description=nil,type=nil,schema=nil,headers=nil,links=nil)-macro","html_id":"json(body,status=200,description=nil,type=nil,schema=nil,headers=nil,links=nil)-macro","name":"json","doc":"Declare a json response.","summary":"<p>Declare a json response.</p>","abstract":false,"args":[{"name":"body","doc":null,"default_value":"","external_name":"body","restriction":""},{"name":"status","doc":null,"default_value":"200","external_name":"status","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"type","doc":null,"default_value":"nil","external_name":"type","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"args_string":"(body, status = <span class=\"n\">200</span>, description = <span class=\"n\">nil</span>, type = <span class=\"n\">nil</span>, schema = <span class=\"n\">nil</span>, headers = <span class=\"n\">nil</span>, links = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/helpers/lucky/responses.cr","line_number":12,"url":null},"def":{"name":"json","args":[{"name":"body","doc":null,"default_value":"","external_name":"body","restriction":""},{"name":"status","doc":null,"default_value":"200","external_name":"status","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"type","doc":null,"default_value":"nil","external_name":"type","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    _controller_response(\n      schema: \n{% if schema %}{{ schema }}{% else %}{% if type %}{{ type }}.to_openapi_schema{% else %}nil{% end %}{% end %}\n,\n      code: \n{{ status }}\n,\n      response: ::OpenAPI::Generator::Helpers::Lucky._init_openapi_response(\n        description: \n{{ description }}\n,\n        code: \n{{ status }}\n,\n        headers: \n{{ headers }}\n,\n        links: \n{{ links }}\n\n      )\n    )\n    self.json(body: \n{{ body }}\n{% if type %}.as({{ type }}){% end %}\n, status: \n{{ status }}\n)\n  \n"}},{"id":"param(declaration,description=nil,multiple=false,schema=nil,**args)-macro","html_id":"param(declaration,description=nil,multiple=false,schema=nil,**args)-macro","name":"param","doc":"Declare a query parameter.","summary":"<p>Declare a query parameter.</p>","abstract":false,"args":[{"name":"declaration","doc":null,"default_value":"","external_name":"declaration","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"multiple","doc":null,"default_value":"false","external_name":"multiple","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"args_string":"(declaration, description = <span class=\"n\">nil</span>, multiple = <span class=\"n\">false</span>, schema = <span class=\"n\">nil</span>, **args)","location":{"filename":"src/openapi-generator/helpers/lucky/query_params.cr","line_number":6,"url":null},"def":{"name":"param","args":[{"name":"declaration","doc":null,"default_value":"","external_name":"declaration","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"multiple","doc":null,"default_value":"false","external_name":"multiple","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""}],"double_splat":{"name":"args","doc":null,"default_value":"","external_name":"args","restriction":""},"splat_index":null,"block_arg":null,"visibility":"Public","body":"    \n{% name = declaration.var.stringify %}\n\n    \n{% type = declaration.type ? declaration.type.resolve : String %}\n\n    \n{% type = type.union_types.reject do |t|\n  t == Nil\nend[0] %}\n\n    _append_query_param(\n      name: \n{{ name }}\n,\n      param: ::OpenAPI::Generator::Helpers::Lucky._init_openapi_parameter(\n        name: \n{{ name }}\n,\n        \"in\": \"query\",\n        required: \n{{ !declaration.type.resolve.nilable? }}\n,\n        schema: \n{% if schema %}{{ schema }}{% else %}{% if multiple %}::OpenAPI::Schema.new(\n          type: \"array\",\n          items: {{ type }}.to_openapi_schema,\n        ){% else %}{{ type }}.to_openapi_schema{% end %}{% end %}\n,\n        description: \n{{ description }}\n,\n        \n{{ **args }}\n\n      ),\n      required: true,\n      multiple: \n{{ multiple }}\n\n    )\n    param(type_declaration: \n{{ declaration }}\n)\n  \n"}},{"id":"plain_text(body,status=200,description=nil,type=String,schema=nil,headers=nil,links=nil)-macro","html_id":"plain_text(body,status=200,description=nil,type=String,schema=nil,headers=nil,links=nil)-macro","name":"plain_text","doc":"Declare a plain text response.","summary":"<p>Declare a plain text response.</p>","abstract":false,"args":[{"name":"body","doc":null,"default_value":"","external_name":"body","restriction":""},{"name":"status","doc":null,"default_value":"200","external_name":"status","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"type","doc":null,"default_value":"String","external_name":"type","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"args_string":"(body, status = <span class=\"n\">200</span>, description = <span class=\"n\">nil</span>, type = <span class=\"t\">String</span>, schema = <span class=\"n\">nil</span>, headers = <span class=\"n\">nil</span>, links = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/helpers/lucky/responses.cr","line_number":59,"url":null},"def":{"name":"plain_text","args":[{"name":"body","doc":null,"default_value":"","external_name":"body","restriction":""},{"name":"status","doc":null,"default_value":"200","external_name":"status","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"type","doc":null,"default_value":"String","external_name":"type","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    _controller_response(\n      schema: \n{% if schema %}{{ schema }}{% else %}{{ type }}.to_openapi_schema{% end %}\n,\n      code: \n{{ status }}\n,\n      response: ::OpenAPI::Generator::Helpers::Lucky._init_openapi_response(\n        description: \n{{ description }}\n,\n        code: \n{{ status }}\n,\n        headers: \n{{ headers }}\n,\n        links: \n{{ links }}\n\n      ),\n      content_type: \"text/plain\"\n    )\n    self.plain_text(body: \n{{ body }}\n{% if type %}.as({{ type }}){% end %}\n, status: \n{{ status }}\n)\n  \n"}},{"id":"xml(body,status=200,description=nil,type=String,schema=nil,headers=nil,links=nil)-macro","html_id":"xml(body,status=200,description=nil,type=String,schema=nil,headers=nil,links=nil)-macro","name":"xml","doc":"Declare an xml response.","summary":"<p>Declare an xml response.</p>","abstract":false,"args":[{"name":"body","doc":null,"default_value":"","external_name":"body","restriction":""},{"name":"status","doc":null,"default_value":"200","external_name":"status","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"type","doc":null,"default_value":"String","external_name":"type","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"args_string":"(body, status = <span class=\"n\">200</span>, description = <span class=\"n\">nil</span>, type = <span class=\"t\">String</span>, schema = <span class=\"n\">nil</span>, headers = <span class=\"n\">nil</span>, links = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/helpers/lucky/responses.cr","line_number":43,"url":null},"def":{"name":"xml","args":[{"name":"body","doc":null,"default_value":"","external_name":"body","restriction":""},{"name":"status","doc":null,"default_value":"200","external_name":"status","restriction":""},{"name":"description","doc":null,"default_value":"nil","external_name":"description","restriction":""},{"name":"type","doc":null,"default_value":"String","external_name":"type","restriction":""},{"name":"schema","doc":null,"default_value":"nil","external_name":"schema","restriction":""},{"name":"headers","doc":null,"default_value":"nil","external_name":"headers","restriction":""},{"name":"links","doc":null,"default_value":"nil","external_name":"links","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    _controller_response(\n      schema: \n{% if schema %}{{ schema }}{% else %}{{ type }}.to_openapi_schema{% end %}\n,\n      code: \n{{ status }}\n,\n      response: ::OpenAPI::Generator::Helpers::Lucky._init_openapi_response(\n        description: \n{{ description }}\n,\n        code: \n{{ status }}\n,\n        headers: \n{{ headers }}\n,\n        links: \n{{ links }}\n\n      ),\n      content_type: \"text/xml\"\n    )\n    self.xml(body: \n{{ body }}\n{% if type %}.as({{ type }}){% end %}\n, status: \n{{ status }}\n)\n  \n"}}],"types":[]}]},{"html_id":"openapi-generator/OpenAPI/Generator/RouteMapping","path":"OpenAPI/Generator/RouteMapping.html","kind":"alias","full_name":"OpenAPI::Generator::RouteMapping","name":"RouteMapping","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/generator.cr","line_number":155,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":true,"aliased":"Tuple(String, String, String, Array(String))","aliased_html":"{<a href=\"../../String.html\">String</a>, <a href=\"../../String.html\">String</a>, <a href=\"../../String.html\">String</a>, Array(<a href=\"../../String.html\">String</a>)}","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator","kind":"module","full_name":"OpenAPI::Generator","name":"Generator"},"doc":"A RouteMapping type is a tuple with the following shape: `{method, full_path, key, path_params}`\n- method: The HTTP Verb of the route. (ex: `\"get\"`)\n- full_path: The full path representation of the route with path parameters between curly braces. (ex: `\"/name/{id}\"`)\n- key: The fully qualified name of the method mapped to the route. (ex: `\"Controller::show\"`)\n- path_params: A list of path parameter names. (ex: `[\"id\", \"name\"]`)","summary":"<p>A RouteMapping type is a tuple with the following shape: <code>{method, full_path, key, path_params}</code> - method: The HTTP Verb of the route.</p>","class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider","path":"OpenAPI/Generator/RoutesProvider.html","kind":"module","full_name":"OpenAPI::Generator::RoutesProvider","name":"RoutesProvider","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/providers/base.cr","line_number":2,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator","kind":"module","full_name":"OpenAPI::Generator","name":"Generator"},"doc":"Framework dependent implementations that should provide a list of routes mapped to a method that get executed on match.","summary":"<p>Framework dependent implementations that should provide a list of routes mapped to a method that get executed on match.</p>","class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/ActionController","path":"OpenAPI/Generator/RoutesProvider/ActionController.html","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::ActionController","name":"ActionController","abstract":false,"superclass":{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Base","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Base","name":"Base"},"ancestors":[{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Base","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Base","name":"Base"},{"html_id":"openapi-generator/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"openapi-generator/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/openapi-generator/providers/action-controller.cr","line_number":6,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider","kind":"module","full_name":"OpenAPI::Generator::RoutesProvider","name":"RoutesProvider"},"doc":"Provides the list of declared routes.","summary":"<p>Provides the list of declared routes.</p>","class_methods":[],"constructors":[],"instance_methods":[{"id":"route_mappings:Array(RouteMapping)-instance-method","html_id":"route_mappings:Array(RouteMapping)-instance-method","name":"route_mappings","doc":"Returns a list of `OpenAPI::Generator::RouteMapping`","summary":"<p>Returns a list of <code><a href=\"../../../OpenAPI/Generator/RouteMapping.html\">OpenAPI::Generator::RouteMapping</a></code></p>","abstract":false,"args":[],"args_string":" : Array(RouteMapping)","args_html":" : Array(<a href=\"../../../OpenAPI/Generator/RouteMapping.html\">RouteMapping</a>)","location":{"filename":"src/openapi-generator/providers/action-controller.cr","line_number":9,"url":null},"def":{"name":"route_mappings","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(RouteMapping)","visibility":"Public","body":"routes = [] of RouteMapping\n::ActionController::Server.routes.each do |route|\n  route_controller, route_method, method, path = route\n  key = \"#{route_controller}::#{route_method}\"\n  path_params = [] of String\n  full_path = ((path.chomp('/')).split('/')).join('/') do |i|\n    if i.starts_with?(':')\n      i = i.lstrip(':')\n      path_params << i\n      \"{#{i}}\"\n    else\n      i\n    end\n  end\n  routes << {method.to_s, full_path, key, path_params}\nend\nroutes\n"}}],"macros":[],"types":[]},{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Amber","path":"OpenAPI/Generator/RoutesProvider/Amber.html","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Amber","name":"Amber","abstract":false,"superclass":{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Base","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Base","name":"Base"},"ancestors":[{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Base","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Base","name":"Base"},{"html_id":"openapi-generator/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"openapi-generator/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/openapi-generator/providers/amber.cr","line_number":20,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider","kind":"module","full_name":"OpenAPI::Generator::RoutesProvider","name":"RoutesProvider"},"doc":"Provides the list of routes declared in an Amber Framework instance.","summary":"<p>Provides the list of routes declared in an Amber Framework instance.</p>","class_methods":[],"constructors":[{"id":"new(included_methods:Array(String)?=nil,included_paths:Array(String)?=nil)-class-method","html_id":"new(included_methods:Array(String)?=nil,included_paths:Array(String)?=nil)-class-method","name":"new","doc":"Initialize the provider with a list of allowed HTTP verbs and path prefixes to filter the routes.","summary":"<p>Initialize the provider with a list of allowed HTTP verbs and path prefixes to filter the routes.</p>","abstract":false,"args":[{"name":"included_methods","doc":null,"default_value":"nil","external_name":"included_methods","restriction":"Array(String) | ::Nil"},{"name":"included_paths","doc":null,"default_value":"nil","external_name":"included_paths","restriction":"Array(String) | ::Nil"}],"args_string":"(included_methods : Array(String)? = <span class=\"n\">nil</span>, included_paths : Array(String)? = <span class=\"n\">nil</span>)","args_html":"(included_methods : Array(<a href=\"../../../String.html\">String</a>)? = <span class=\"n\">nil</span>, included_paths : Array(<a href=\"../../../String.html\">String</a>)? = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/providers/amber.cr","line_number":22,"url":null},"def":{"name":"new","args":[{"name":"included_methods","doc":null,"default_value":"nil","external_name":"included_methods","restriction":"Array(String) | ::Nil"},{"name":"included_paths","doc":null,"default_value":"nil","external_name":"included_paths","restriction":"Array(String) | ::Nil"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(included_methods, included_paths)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"route_mappings:Array(RouteMapping)-instance-method","html_id":"route_mappings:Array(RouteMapping)-instance-method","name":"route_mappings","doc":"Return a list of routes mapped with the controllers and methods.","summary":"<p>Return a list of routes mapped with the controllers and methods.</p>","abstract":false,"args":[],"args_string":" : Array(RouteMapping)","args_html":" : Array(<a href=\"../../../OpenAPI/Generator/RouteMapping.html\">RouteMapping</a>)","location":{"filename":"src/openapi-generator/providers/amber.cr","line_number":26,"url":null},"def":{"name":"route_mappings","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(RouteMapping)","visibility":"Public","body":"routes = [] of RouteMapping\n::Amber::Server.router.routes.each_route(->(full_path : String, route : ::Amber::Route) do\n  method, paths, path_params = ((full_path.gsub(\"//\", \"/\")).split(\"/\")).reduce({\"\", [] of String, [] of String}) do |acc, segment|\n    method, path_array, params = acc\n    if method.empty?\n      {segment, path_array, params}\n    else\n      if segment.starts_with?(':')\n        param = segment[1..]\n        path_array << \"{#{param}}\"\n        params << param\n        acc\n      else\n        path_array << \"#{segment}\"\n        acc\n      end\n    end\n  end\n  string_path = \"/#{paths.join(\"/\")}\"\n  key = \"#{route.controller}::#{route.action}\"\n  if (  (@included_methods.nil? || @included_methods.try(&.includes?(method))) && (@included_paths.nil? || @included_paths.try(&.any? do |p|\n    string_path.starts_with?(p)\n  end)))\n    routes << {method, string_path, key, path_params}\n  end\nend)\nroutes\n"}}],"macros":[],"types":[]},{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Base","path":"OpenAPI/Generator/RoutesProvider/Base.html","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Base","name":"Base","abstract":true,"superclass":{"html_id":"openapi-generator/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"openapi-generator/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"openapi-generator/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/openapi-generator/providers/base.cr","line_number":6,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/ActionController","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::ActionController","name":"ActionController"},{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Amber","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Amber","name":"Amber"},{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Lucky","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Lucky","name":"Lucky"}],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider","kind":"module","full_name":"OpenAPI::Generator::RoutesProvider","name":"RoutesProvider"},"doc":"Base class for route providers.","summary":"<p>Base class for route providers.</p>","class_methods":[],"constructors":[],"instance_methods":[{"id":"route_mappings:Array(RouteMapping)-instance-method","html_id":"route_mappings:Array(RouteMapping)-instance-method","name":"route_mappings","doc":"Returns a list of `OpenAPI::Generator::RouteMapping`","summary":"<p>Returns a list of <code><a href=\"../../../OpenAPI/Generator/RouteMapping.html\">OpenAPI::Generator::RouteMapping</a></code></p>","abstract":true,"args":[],"args_string":" : Array(RouteMapping)","args_html":" : Array(<a href=\"../../../OpenAPI/Generator/RouteMapping.html\">RouteMapping</a>)","location":{"filename":"src/openapi-generator/providers/base.cr","line_number":8,"url":null},"def":{"name":"route_mappings","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(RouteMapping)","visibility":"Public","body":""}}],"macros":[],"types":[]},{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Lucky","path":"OpenAPI/Generator/RoutesProvider/Lucky.html","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Lucky","name":"Lucky","abstract":false,"superclass":{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Base","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Base","name":"Base"},"ancestors":[{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider/Base","kind":"class","full_name":"OpenAPI::Generator::RoutesProvider::Base","name":"Base"},{"html_id":"openapi-generator/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"openapi-generator/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/openapi-generator/providers/lucky.cr","line_number":5,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator/RoutesProvider","kind":"module","full_name":"OpenAPI::Generator::RoutesProvider","name":"RoutesProvider"},"doc":"Provides the list of declared routes.","summary":"<p>Provides the list of declared routes.</p>","class_methods":[],"constructors":[],"instance_methods":[{"id":"route_mappings:Array(RouteMapping)-instance-method","html_id":"route_mappings:Array(RouteMapping)-instance-method","name":"route_mappings","doc":"Return a list of routes mapped with the action classes.","summary":"<p>Return a list of routes mapped with the action classes.</p>","abstract":false,"args":[],"args_string":" : Array(RouteMapping)","args_html":" : Array(<a href=\"../../../OpenAPI/Generator/RouteMapping.html\">RouteMapping</a>)","location":{"filename":"src/openapi-generator/providers/lucky.cr","line_number":7,"url":null},"def":{"name":"route_mappings","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(RouteMapping)","visibility":"Public","body":"routes = [] of RouteMapping\n::Lucky::Router.routes.map do |route|\n  paths, path_params = (route.path.split(\"/\")).reduce({[] of String, [] of String}) do |acc, segment|\n    path_array, params = acc\n    if (segment.starts_with?(':')) || (segment.starts_with?('?'))\n      param = segment.gsub(/^[?:]+/, \"\")\n      path_array << \"{#{param}}\"\n      params << param\n      acc\n    else\n      path_array << segment\n      acc\n    end\n  end\n  routes << {route.method.to_s, paths.join(\"/\"), route.action.to_s, path_params}\nend\nroutes\n"}}],"macros":[],"types":[]}]},{"html_id":"openapi-generator/OpenAPI/Generator/Serializable","path":"OpenAPI/Generator/Serializable.html","kind":"module","full_name":"OpenAPI::Generator::Serializable","name":"Serializable","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/openapi-generator/serializable.cr","line_number":56,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[{"id":"SERIALIZABLE_CLASSES","name":"SERIALIZABLE_CLASSES","value":"[] of Class","doc":"A list of all serializable subclasses.","summary":"<p>A list of all serializable subclasses.</p>"}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"openapi-generator/OpenAPI/Generator","kind":"module","full_name":"OpenAPI::Generator","name":"Generator"},"doc":"The `Serializable` module automatically generates an OpenAPI Operations representation of the class or struct when extended.\n\n### Example\n\n```\nstruct Model\n  extend OpenAPI::Generator::Serializable\n  include JSON::Serializable\n\n  property string : String\n  property opt_string : String?\n  @[OpenAPI::Field(ignore: true)]\n  property ignored : Nil\n  @[OpenAPI::Field(type: String, example: \"1\")]\n  @cast : Int32\n\n  def cast\n    @cast.to_s\n  end\nend\n\nputs Model.to_openapi_schema.to_pretty_json\n# => {\n#   \"required\": [\n#     \"string\",\n#     \"cast\"\n#   ],\n#   \"type\": \"object\",\n#   \"properties\": {\n#     \"string\": {\n#       \"type\": \"string\"\n#     },\n#     \"opt_string\": {\n#       \"type\": \"string\"\n#     },\n#     \"cast\": {\n#       \"type\": \"string\",\n#       \"example\": \"1\"\n#     }\n#   }\n# }\n```\n\n### Usage\n\nExtending this module adds a `self.to_openapi_schema` that returns an OpenAPI representation\ninferred from the shape of the class or struct.\n\nThe class name is also registered as a global [component schema](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#components-object)\nand will be available for referencing from any `Controller` annotation from a [reference object](https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md#referenceObject).\n\n**See:** `OpenAPI::Generator::Controller::Schema.ref`\n\nNOTE: **Calling `to_openapi_schema` programatically is unnecessary.\nThe `Generator` will take care of serialization while producing the openapi yaml file.**","summary":"<p>The <code><a href=\"../../OpenAPI/Generator/Serializable.html\">Serializable</a></code> module automatically generates an OpenAPI Operations representation of the class or struct when extended.</p>","class_methods":[],"constructors":[],"instance_methods":[{"id":"generate_schema-instance-method","html_id":"generate_schema-instance-method","name":"generate_schema","doc":"Serialize the class into an `OpenAPI::Schema` representation.\n\nCheck the [swagger documentation](https://swagger.io/docs/specification/data-models/) for more details","summary":"<p>Serialize the class into an <code>OpenAPI::Schema</code> representation.</p>","abstract":false,"args":[],"args_string":"","args_html":"","location":{"filename":"src/openapi-generator/serializable.cr","line_number":238,"url":null},"def":{"name":"generate_schema","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"schema = OpenAPI::Schema.new(type: \"object\", properties: Hash(String, OpenAPI::Schema | OpenAPI::Reference).new, required: [] of String)\n{% for ivar in @type.instance_vars %}\n\n      {% json_ann = ivar.annotation(JSON::Field) %}\n      {% openapi_ann = ivar.annotation(OpenAPI::Field) %}\n      {% types = ivar.type.union_types %}\n      {% schema_key = (json_ann && json_ann[:key]) || ivar.id %}\n      {% as_type = (openapi_ann && openapi_ann[:type]) && openapi_ann[:type].types.map(&.resolve) %}\n      {% read_only = openapi_ann && openapi_ann[:read_only] %}\n      {% write_only = openapi_ann && openapi_ann[:write_only] %}\n      {% example = openapi_ann && openapi_ann[:example] %}\n\n      {% if json_ann && json_ann[:ignore] %}{% else %}\n        ::OpenAPI::Generator::Serializable.generate_schema(\n          schema,\n          types: {{ types }},\n          schema_key: {{ schema_key }},\n          as_type: {{ as_type }},\n          read_only: {{ read_only }},\n          write_only: {{ write_only }},\n          example: {{ example }}\n        )\n      {% end %}\n\n    {% end %}\nschema\n"}},{"id":"to_openapi_schema-instance-method","html_id":"to_openapi_schema-instance-method","name":"to_openapi_schema","doc":"Serialize the class into an `OpenAPI::Reference` representation.\n\nCheck the [swagger documentation](https://swagger.io/docs/specification/data-models/) for more details","summary":"<p>Serialize the class into an <code>OpenAPI::Reference</code> representation.</p>","abstract":false,"args":[],"args_string":"","args_html":"","location":{"filename":"src/openapi-generator/serializable.cr","line_number":277,"url":null},"def":{"name":"to_openapi_schema","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"OpenAPI::Schema.new(all_of: [OpenAPI::Reference.new(ref: \"#/components/schemas/#{URI.encode_www_form({{ (@type.stringify.split(\"::\")).join(\"_\") }})}\")])"}}],"macros":[{"id":"generate_schema(schema,types,as_type=nil,read_only=false,write_only=false,schema_key=nil,example=nil)-macro","html_id":"generate_schema(schema,types,as_type=nil,read_only=false,write_only=false,schema_key=nil,example=nil)-macro","name":"generate_schema","doc":null,"summary":null,"abstract":false,"args":[{"name":"schema","doc":null,"default_value":"","external_name":"schema","restriction":""},{"name":"types","doc":null,"default_value":"","external_name":"types","restriction":""},{"name":"as_type","doc":null,"default_value":"nil","external_name":"as_type","restriction":""},{"name":"read_only","doc":null,"default_value":"false","external_name":"read_only","restriction":""},{"name":"write_only","doc":null,"default_value":"false","external_name":"write_only","restriction":""},{"name":"schema_key","doc":null,"default_value":"nil","external_name":"schema_key","restriction":""},{"name":"example","doc":null,"default_value":"nil","external_name":"example","restriction":""}],"args_string":"(schema, types, as_type = <span class=\"n\">nil</span>, read_only = <span class=\"n\">false</span>, write_only = <span class=\"n\">false</span>, schema_key = <span class=\"n\">nil</span>, example = <span class=\"n\">nil</span>)","location":{"filename":"src/openapi-generator/serializable.cr","line_number":83,"url":null},"def":{"name":"generate_schema","args":[{"name":"schema","doc":null,"default_value":"","external_name":"schema","restriction":""},{"name":"types","doc":null,"default_value":"","external_name":"types","restriction":""},{"name":"as_type","doc":null,"default_value":"nil","external_name":"as_type","restriction":""},{"name":"read_only","doc":null,"default_value":"false","external_name":"read_only","restriction":""},{"name":"write_only","doc":null,"default_value":"false","external_name":"write_only","restriction":""},{"name":"schema_key","doc":null,"default_value":"nil","external_name":"schema_key","restriction":""},{"name":"example","doc":null,"default_value":"nil","external_name":"example","restriction":""}],"double_splat":null,"splat_index":null,"block_arg":null,"visibility":"Public","body":"    \n{% serialized_types = [] of ::Tuple(String, TypeNode | ArrayLiteral(TypeNode) | ::Nil) %}\n\n    \n{% nilable = types.any? do |t|\n  t.resolve.nilable?\nend %}\n\n\n    \n# For every type of the instance variable (can be a union, like String | Int32)…\n\n    \n{% for type in (as_type || types) %}\n      {% type = type.resolve %}\n      # Serialize the type into an OpenAPI representation.\n      # Also store extra data for objects and arrays.\n      {% if type <= Union(String, Char) %}\n        {% serialized_types << {\"string\"} %}\n      {% else %}{% if type <= Union(Int8, Int16, Int32, Int64, UInt8, UInt16, UInt32, UInt64) %}\n        {% serialized_types << {\"integer\"} %}\n      {% else %}{% if type <= Union(Float32, Float64) %}\n        {% serialized_types << {\"number\"} %}\n      {% else %}{% if type == Bool %}\n        {% serialized_types << {\"boolean\"} %}\n      {% else %}{% if OpenAPI::Generator::Serializable::SERIALIZABLE_CLASSES.includes?(type) %}\n        {% serialized_types << {\"object\", type} %}\n      {% else %}{% if type.class.has_method?(:to_openapi_schema) %}\n        {% serialized_types << {\"self_schema\", type} %}\n      {% else %}{% if type <= JSON::Any %}\n        {% serialized_types << {\"free_form\"} %}\n      {% else %}\n        {%  %}\n      {% end %}{% end %}{% end %}{% end %}{% end %}{% end %}{% end %}\n    {% end %}\n\n\n    \n{% if (schema_key && serialized_types.size > 0) && (!nilable) %}\n      {{ schema }}.required.not_nil! << {{ schema_key.stringify }}\n    {% end %}\n\n\n    \n{% if serialized_types.size == 1 %}\n      # As there is only one supported type…\n      %items = nil\n      %generated_schema = nil\n      %additional_properties = nil\n\n      {% serialized_type = serialized_types[0] %}\n      {% type = serialized_type[0] %}\n      {% extra = serialized_type[1] %}\n\n      {% if type == \"object\" %}\n        %type = nil\n        # Store a reference to another object.\n        {% if read_only || write_only %}\n        %generated_schema = OpenAPI::Schema.new(\n          read_only: {{ read_only }},\n          write_only: {{ write_only }},\n          all_of: [\n            OpenAPI::Reference.new ref: \"#/components/schemas/#{URI.encode_www_form({{ (extra.stringify.split(\"::\")).join(\"_\") }})}\"\n          ]\n        )\n        {% else %}\n        %generated_schema = OpenAPI::Reference.new ref: \"#/components/schemas/#{URI.encode_www_form({{ (extra.stringify.split(\"::\")).join(\"_\") }})}\"\n        {% end %}\n      {% else %}{% if type == \"self_schema\" %}\n        %type = nil\n        %generated_schema = {{ extra }}.to_openapi_schema\n        {% if read_only %}\n        %generated_schema.read_only = true\n        {% end %}\n        {% if write_only %}\n        %generated_schema.write_only = true\n        {% end %}\n      {% else %}{% if type == \"free_form\" %}\n        # Free form object\n        %type = \"object\"\n        %additional_properties = true\n      {% else %}\n        # This is a basic type.\n        %type = {{ type }}\n      {% end %}{% end %}{% end %}\n\n      if %type\n        {% if schema_key %}{{ schema }}.properties.not_nil![\"{{ schema_key }}\"]{% else %}{{ schema }}{% end %} = OpenAPI::Schema.new(\n          type: %type,\n          items: %items,\n          additional_properties: %additional_properties,\n          {% if read_only %}  read_only:  {{ read_only }},  {% end %}\n          {% if write_only %} write_only: {{ write_only }}, {% end %}\n          {% if example != nil %}example: {{ example }},    {% end %}\n        )\n      elsif %generated_schema\n        {% if schema_key %}{{ schema }}.properties.not_nil![\"{{ schema_key }}\"]{% else %}{{ schema }}{% end %} = %generated_schema\n      end\n\n    {% else %}{% if serialized_types.size > 1 %}\n      # There are multiple supported types, so we create a \"oneOf\" array…\n      %one_of = [] of OpenAPI::Schema | OpenAPI::Reference\n\n      # And for each type…\n      {% for serialized_type in serialized_types %}\n        {% type = serialized_type[0] %}\n        {% extra = serialized_type[1] %}\n\n        %items = nil\n        %additional_properties = nil\n        %generated_schema = nil\n\n        {% if type == \"object\" %}\n          %type = nil\n          {% if read_only || write_only %}\n          %generated_schema = OpenAPI::Schema.new(\n            read_only: {{ read_only }},\n            write_only: {{ write_only }},\n            all_of: [\n              OpenAPI::Reference.new ref: \"#/components/schemas/#{URI.encode_www_form({{ (extra.stringify.split(\"::\")).join(\"_\") }})}\"\n            ]\n          )\n          {% else %}\n          %generated_schema = OpenAPI::Reference.new ref: \"#/components/schemas/#{URI.encode_www_form({{ (extra.stringify.split(\"::\")).join(\"_\") }})}\"\n          {% end %}\n        {% else %}{% if type == \"self_schema\" %}\n          %type = nil\n          %generated_schema = {{ extra }}.to_openapi_schema\n          {% if read_only %}\n          %generated_schema.read_only = true\n          {% end %}\n          {% if write_only %}\n          %generated_schema.write_only = true\n          {% end %}\n        {% else %}{% if type == \"free_form\" %}\n          # Free form object\n          %type = \"object\"\n          %additional_properties = true\n        {% else %}\n          # This is a basic type.\n          %type = {{ type }}\n        {% end %}{% end %}{% end %}\n\n        # We append the reference, or schema to the \"oneOf\" array.\n        if %type\n          %one_of << OpenAPI::Schema.new(\n            type: %type,\n            items: %items,\n            additional_properties: %additional_properties,\n            {% if read_only %}  read_only:  {{ read_only }},  {% end %}\n            {% if write_only %} write_only: {{ write_only }}, {% end %}\n            {% if example != nil %}example: {{ example }},    {% end %}\n          )\n        elsif %generated_schema\n          %one_of << %generated_schema\n        end\n      {% end %}\n\n      {% if schema_key %}{{ schema }}.properties.not_nil![\"{{ schema_key }}\"]{% else %}{{ schema }}{% end %} = OpenAPI::Schema.new(one_of: %one_of)\n    {% end %}{% end %}\n\n  \n"}}],"types":[]}]}]},{"html_id":"openapi-generator/String","path":"String.html","kind":"class","full_name":"String","name":"String","abstract":false,"superclass":{"html_id":"openapi-generator/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"openapi-generator/Amber/Extensions/String","kind":"module","full_name":"Amber::Extensions::String","name":"String"},{"html_id":"openapi-generator/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"openapi-generator/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"openapi-generator/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"lib/amber/src/amber/extensions/core.cr","line_number":6,"url":null},{"filename":"lib/avram/src/avram/charms/string_extensions.cr","line_number":1,"url":null},{"filename":"lib/blank/src/blank.cr","line_number":29,"url":null},{"filename":"lib/http-params-serializable/src/http-params-serializable/ext/string.cr","line_number":3,"url":null},{"filename":"lib/lucky/src/charms/string_extensions.cr","line_number":1,"url":null},{"filename":"src/openapi-generator/extensions.cr","line_number":74,"url":null}],"repository_name":"openapi-generator","program":false,"enum":false,"alias":false,"aliased":null,"aliased_html":null,"const":false,"constants":[],"included_modules":[{"html_id":"openapi-generator/Amber/Extensions/String","kind":"module","full_name":"Amber::Extensions::String","name":"String"},{"html_id":"openapi-generator/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"}],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":"We are patching the String class and Number struct to extend the predicates\navailable. This will allow to add friendlier methods for validation cases.","summary":"<p>We are patching the String class and Number struct to extend the predicates available.</p>","class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]}]}}